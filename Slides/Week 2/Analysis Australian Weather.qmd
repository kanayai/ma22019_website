---
title: "Analysis of Australian weather data"
author: "Christian Rohrbeck"
date: "12 February 2025"
format: html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, message=FALSE}
library(dplyr)
library(lubridate)
library(ggplot2)
library(patchwork)
```

## Loading and cleaning the data

```{r}
AUS <- read.csv( "WeatherAustralia.csv" )
AUS$Date <- as_date( AUS$Date, format="%d/%m/%Y" )
glimpse( AUS )
```

We can extract the list of locations using

```{r}
AUS %>% distinct( Location )
```

## Analysis of Minimum vs Maximum temperature


### Setting up the canvas

```{r, fig.align='center', fig.width=3, fig.height=3, out.width='40%'}
PlotAUS <- ggplot( AUS, aes( x=MinTemp, y=MaxTemp ) )
PlotAUS
```

### Scatter plot

```{r, fig.width=3, fig.height=3, out.width='40%', fig.align='center'}
PlotAUS + geom_point()
```

### Scatter plot - Adding visual cues

```{r, warning=F, out.width='40%', fig.width=5, fig.height=3, fig.align='center'}
PlotAUS + geom_point( aes( shape=Location, color=Location ) )
```

### Scatter plot - Facets

```{r, warning=F, fig.align='center', out.width='50%', fig.height=4, fig.width=6}
PlotAUS + geom_point() +
  facet_wrap( ~Location ) +
  labs( x="Minimum daily temperature", y="Maximum daily temperature" )
```

### Line plot - Maximum daily temperature over time

Let's create a line plot for the city of Darwin:

```{r, warning=F, out.width='50%', fig.align='center', fig.width=5, fig.height=3}
Darwin <- AUS %>% filter( Location == "Darwin" )
ggplot( Darwin, aes(x=Date, y=MaxTemp ) ) + geom_line() + 
  labs( x="Date", y="Maximum daily temperature", title = "Darwin" )
```

We can again use facets to create a subplot for each city:


```{r, warning=F, fig.align='center', out.width='80%'}
ggplot( AUS, aes( x=Date, y=MaxTemp ) ) + facet_wrap( ~Location ) + 
  geom_line( aes( color=Location, linetype=Location ) ) + 
  labs( x="Date", y="Maximum daily temperature" )
```


## Analysis of wind gust speed

### Histogram for Darwin {-}

We use geom_histogram() to create a single histogram

```{r, warning=F, out.width='50%', fig.align='center', fig.width=5, fig.height=3}
ggplot( Darwin, aes( x=WindGustSpeed ) ) + geom_histogram( bins=20 ) + 
  labs( x="Speed of wind gust in km/h", y="Count", title = "Darwin" )
```


### Density plot

Let's compare histogram and density plot

```{r, warning=FALSE, out.width='50%', fig.align='center', fig.width=5, fig.height=3}
ggplot( Darwin, aes( x=WindGustSpeed ) ) +
  geom_histogram( aes(y=..density..), alpha=0.5, bins=20 ) +
  geom_density( size=1.2, color="red" ) +
  labs( x="Speed of wind gust in km/h", y="Density", title = "Darwin" )
```


```{r, warning=FALSE, out.width='50%', fig.align='center', fig.width=6, fig.height=3}
WeatherAD <- filter( AUS, Location %in% c("Adelaide","Darwin") )
ggplot( WeatherAD, aes( x=WindGustSpeed ) ) +
  geom_density( aes( linetype=Location, color=Location ), size=1.2 ) +
  labs( x="Speed of wind gust in km/h", y="Density" )
```

### Box plots

```{r, warning=F, out.width='70%', fig.align='center', fig.width=5, fig.height=3}
ggplot( AUS, aes( x=Location, y=WindGustSpeed ) ) + 
  geom_boxplot( aes( fill=Location ) ) + 
  labs( y="Speed of wind gust in km/h" )
```

### Violin plots


```{r, warning=F, out.width='70%', fig.align='center', fig.width=5, fig.height=3}
ggplot( AUS, aes( x=reorder(Location, WindGustSpeed, median, na.rm=TRUE), 
                  y=WindGustSpeed ) ) + geom_violin() + 
  labs( x="Location", y="Wind gust speed in mph", 
        title="Wind gust speed across five Australian cities" )
```