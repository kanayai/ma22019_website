---
title: "MA22019 2025 - Quiz 8"
subtitle: "Mise en place"
description: "To work after "
categories: "Quiz"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### **Overview**

This week's problem sheet focuses on the methods for analyzing spatial dependence introduced in Sections 4.3 and 4.4 in the lecture notes. Exercises 1-2 help you with revising the content of the lecture in Week 8.

You may want to load the following packages before starting the exercise:

```{r, message=FALSE, warning=FALSE}
library( dplyr )
library( lubridate )
library( ggplot2 )
library( tidyr )
library( sf )
library( ggspatial )
library( prettymapr )
library( sp )
library( gstat )
```

When working on a University PC, you will have to first install some of these packages. 



### **Exercise 1 - Exploring spatial structure in river flow data**

A data scientist used principal component analysis to explore the spatial structure / dependence in the daily maximum river flow values across 45 gauges in Northern England and the South of Scotland. They identified that the first 3 components explain more than 90% of the variation in the data and created the following plots representing the first three eigenvectors:

```{r, fig.align='center', out.width='100%', fig.width=12, fig.height=7, echo=FALSE, warning=FALSE, message=FALSE}
RF <- read.csv("data/River Flow.csv")
RF <- RF %>% na.omit() 
PCA <- prcomp( RF, scale. = TRUE )
Loc <- read.csv("data/Locations River Flow.csv")
Loc <- Loc %>%
  mutate( PC1 = PCA$rotation[,1], PC2 = PCA$rotation[,2], PC3 = PCA$rotation[,3] ) %>%
  pivot_longer( cols=PC1:PC3, names_to="PC" )
GB <- read_sf( "Data/Shapefiles/gadm41_GBR/gadm41_GBR_2.shp" )
GB <- GB %>% st_simplify( dTolerance = 500 )
ggplot( GB ) + geom_sf(fill="white") + theme_bw() +
  geom_point(data=Loc, aes(x=Lon,y=Lat,color=value), size=5 ) + 
  scale_color_distiller( palette="Blues" ) +
  xlim(-3.5,-1) + ylim(53,55.5) + 
  facet_wrap( ~PC ) +
  labs( x="Longitude", y="Latitude", color="value" )
```

Provide an interpretation for the three plots and then go to Moodle and complete the quiz.


### **Exercise 2 - Concentrations of zinc in the top soil**

The file "Meuse.csv" gives topsoil zinc concentrations (in mg/kg) collected across 155 locations in a flood plain of the river Meuse. Specifically, we are given

* Lon,Lat - Longitude and latitude coordinate of the locations

* Zinc - Zinc concentration on logarithmic scale

Perform the following steps to explore the spatial structure in the data:

a) Visualize the zinc concentration on logarithmic scale using the ggspatial package. What do you conclude?

b) Explore the spatial dependence in the zinc concentration on logarithmic scale by estimating the semi-variogram for the data. Go to Moodle and answer the quiz.

