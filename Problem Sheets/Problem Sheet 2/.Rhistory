select( -Potas, -Sulf )
ggplot( Orchids, aes(x=Sulf, y=Height) ) + facet_wrap(~Type) +
geom_smooth()
head(Orchids)
ggplot( Orchids, aes(x=Phos, y=Height) ) + facet_wrap(~Type) +
geom_smooth()
Orchids$Phos  <- na_if( Orchids$Phos, 0 )
ggplot( Orchids, aes(x=Phos, y=Height) ) + facet_wrap(~Type) +
geom_smooth()
Orchids <- Orchids %>% mutate( Sell = as.numeric(Quality>6) )
ggplot( Orchids, aes(x=Phos, y=Quality) ) + facet_wrap(~Type) +
geom_smooth()
ggplot( Orchids, aes(x=Temp, y=Quality) ) + facet_wrap(~Type) +
geom_smooth()
Orchids$Planting <- as_date( Orchids$Planting )
ggplot( Orchids, aes(x=Planting, y=Quality) ) + facet_wrap(~Type) +
geom_smooth()
ggplot( Orchids, aes(x=Planting, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
ggplot( Orchids, aes(x=Phos, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
#### Data Question 1
library(dplyr)
set.seed( 2022 )
n <- 3415
## V2: Phosphate Levels pmm
Phospate <- rgamma( n, shape=60, rate=0.75)
## V3: Date of planting
library(lubridate)
Date <- as_date("2024-03-01", format="%Y-%m-%d")
Date <- Date + round( 60 * rbeta(n, 2, 3 ) )
hist( Date, breaks=20 )
library(dplyr)
library(lubridate)
set.seed( 2022 )
n <- 3415
## V2: Phosphate Levels pmm
Phospate <- rgamma( n, shape=60, rate=0.75)
## V3: Date of planting
library(lubridate)
Date <- as_date("2024-03-01", format="%Y-%m-%d")
Date <- Date + round( 60 * rbeta(n, 2, 3 ) )
hist( Date, breaks=20 )
hist( Date, breaks=20 )
## V4: Type of plant
orchids <- c( "Cymbidium", "Dendrobium" )
Types <- sample( orchids, n, replace=T )
## V5: Temperature
Temp <- rep(0,n)
for( i in 1:n ){
Temp[i] <- case_when(
Types[i] == "Cymbidium" ~ 16.4 + 4.7 * rbeta(1,2,2),
Types[i] == "Dendrobium" ~ 17.5 + 5.2 * rbeta(1,2,2),
)
}
## V1: Orchid Height in inches
height <- c( 17, 30 )
Height <- rep( 0, n )
ind <- which( Types == "Cymbidium" )
Height[ind] <- height[1] + 0.2 * sqrt(Phospate[ind]) +
0.3 * log( as.numeric(as_date("2022-10-15") - Date[ind]) ) +
0.3 * (Temp[ind]-17) - 7 + rnorm( length(ind), sd=height[1]/10 )
ind <- which( Types == "Cymbidium" )
Height[ind] <- height[1] + 0.2 * sqrt(Phospate[ind]) +
0.3 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.3 * (Temp[ind]-17) - 7 + rnorm( length(ind), sd=height[1]/10 )
ind <- which( Types == "Dendrobium" )
Height[ind] <- height[2] + 0.3 * sqrt(Phospate[ind]) +
0.35 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.4 * (Temp[ind]-17) - 10 +
rnorm( length(ind), sd=height[2]/10 )
##V8: Quality
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 8 - 6/50 * abs (
as.numeric( as_date("2022-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -2, 2) )
min(Quality[ind])
Quality[ind] <-
round( 8 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -2, 2) )
min(Quality[ind])
max(Quality[ind])
6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] )
)
max(Height[ind])
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -2, 2) ) +
0.15 * Height[ind]
min(Quality)
min(Quality[ind])
max(Quality[ind])
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -4, 0) ) +
0.15 * Height[ind]
min(Quality[ind])
max(Quality[ind])
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) ) +
0.15 * Height[ind]
min(Quality[ind])
max(Quality[ind])
ind <- which( Types == "Dendrobium" )
min(Height[ind])
max(Height[ind])
library(dplyr)
library(lubridate)
set.seed( 2022 )
n <- 3415
## V2: Phosphate Levels pmm
Phospate <- rgamma( n, shape=60, rate=0.75)
## V3: Date of planting
Date <- as_date("2024-03-01", format="%Y-%m-%d")
Date <- Date + round( 60 * rbeta(n, 2, 3 ) )
hist( Date, breaks=20 )
## V4: Type of plant
orchids <- c( "Cymbidium", "Dendrobium" )
Types <- sample( orchids, n, replace=T )
## V5: Temperature
Temp <- rep(0,n)
for( i in 1:n ){
Temp[i] <- case_when(
Types[i] == "Cymbidium" ~ 16.4 + 4.7 * rbeta(1,2,2),
Types[i] == "Dendrobium" ~ 17.5 + 5.2 * rbeta(1,2,2),
)
}
## V1: Orchid Height in inches
height <- c( 17, 30 )
Height <- rep( 0, n )
ind <- which( Types == "Cymbidium" )
Height[ind] <- height[1] + 0.2 * sqrt(Phospate[ind]) +
0.3 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.3 * (Temp[ind]-17) - 7 + rnorm( length(ind), sd=height[1]/10 )
ind <- which( Types == "Dendrobium" )
Height[ind] <- height[2] + 0.3 * sqrt(Phospate[ind]) +
0.35 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.4 * (Temp[ind]-17) - 10 +
rnorm( length(ind), sd=height[2]/10 )
##V8: Quality
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) ) +
0.15 * Height[ind]
ind <- which( Types == "Dendrobium" )
Quality[ind] <-
round( 8 - 6/50 * abs (
as.numeric( as_date("2022-04-01") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) )  +
0.05 * Height[ind]
ind <- rbinom( n, 1, 0.1 )
Quality[ind==1] <- 0
Orchids <- data.frame( "Type"=Types,
"Height"=round(Height,1),
"Quality"=round(Quality),
"Phosphate"=round(Phospate),
"Temperature"=round(Temp,1),
"Planting"=Date )
ggplot( Orchids, aes(x=Phosphate, y=Height) ) + facet_wrap(~Type) +
geom_smooth()
Orchids$Quality  <- na_if( Orchids$Quality, 0 )
ggplot( Orchids, aes(x=Phos, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
Orchids <- Orchids %>% mutate( Sell = as.numeric(Quality>6) )
Orchids$Planting <- as_date( Orchids$Planting )
ggplot( Orchids, aes(x=Phos, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
ggplot( Orchids, aes(x=Phosphate, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
library(dplyr)
library(lubridate)
set.seed( 2022 )
n <- 3415
## V2: Phosphate Levels pmm
Phospate <- rgamma( n, shape=60, rate=0.75)
## V3: Date of planting
Date <- as_date("2024-03-01", format="%Y-%m-%d")
Date <- Date + round( 60 * rbeta(n, 2, 3 ) )
hist( Date, breaks=20 )
## V4: Type of plant
orchids <- c( "Cymbidium", "Dendrobium" )
Types <- sample( orchids, n, replace=T )
## V5: Temperature
Temp <- rep(0,n)
for( i in 1:n ){
Temp[i] <- case_when(
Types[i] == "Cymbidium" ~ 16.4 + 4.7 * rbeta(1,2,2),
Types[i] == "Dendrobium" ~ 17.5 + 5.2 * rbeta(1,2,2),
)
}
## V1: Orchid Height in inches
height <- c( 17, 30 )
Height <- rep( 0, n )
ind <- which( Types == "Cymbidium" )
Height[ind] <- height[1] + 0.2 * sqrt(Phospate[ind]) +
0.3 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.3 * (Temp[ind]-17) - 7 + rnorm( length(ind), sd=height[1]/10 )
ind <- which( Types == "Dendrobium" )
Height[ind] <- height[2] + 0.3 * sqrt(Phospate[ind]) +
0.35 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.4 * (Temp[ind]-17) - 10 +
rnorm( length(ind), sd=height[2]/10 )
##V8: Quality
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) ) +
0.15 * Height[ind]
ind <- which( Types == "Dendrobium" )
Quality[ind] <-
round( 8 - 6/50 * abs (
as.numeric( as_date("2022-04-01") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) )  +
0.05 * Height[ind]
ind <- rbinom( n, 1, 0.1 )
Quality[ind==1] <- 0
Orchids <- data.frame( "Type"=Types,
"Height"=round(Height,1),
"Quality"=round(Quality),
"Phosphate"=round(Phospate),
"Temperature"=round(Temp,1),
"Planting"=Date )
setwd("C:/Users/cr777/Desktop/Teaching 2024-2025/MA22019/Problem Sheets/Problem Sheet 2//")
write.csv( Orchids, "Orchids.csv", row.names = FALSE )
Orchids <- read.csv("Orchids.csv")
unique(Orchids$Type)
ggplot( Orchids, aes(x=Phosphate, y=Height) ) + facet_wrap(~Type) +
geom_smooth()
Orchids$Quality  <- na_if( Orchids$Quality, 0 )
Orchids <- Orchids %>% mutate( Sell = as.numeric(Quality>6) )
Orchids$Planting <- as_date( Orchids$Planting )
ggplot( Orchids, aes(x=Phosphate, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
Orchids %>%
group_by(Type) %>%
summarise( mean(Sell, na.rm=TRUE) )
library(dplyr)
library(lubridate)
set.seed( 2022 )
n <- 3415
## V2: Phosphate Levels pmm
Phospate <- rgamma( n, shape=60, rate=0.75)
## V3: Date of planting
Date <- as_date("2024-03-01", format="%Y-%m-%d")
Date <- Date + round( 60 * rbeta(n, 2, 3 ) )
hist( Date, breaks=20 )
## V4: Type of plant
orchids <- c( "Cymbidium", "Dendrobium" )
Types <- sample( orchids, n, replace=T )
## V5: Temperature
Temp <- rep(0,n)
for( i in 1:n ){
Temp[i] <- case_when(
Types[i] == "Cymbidium" ~ 16.4 + 4.7 * rbeta(1,2,2),
Types[i] == "Dendrobium" ~ 17.5 + 5.2 * rbeta(1,2,2),
)
}
## V1: Orchid Height in inches
height <- c( 17, 30 )
Height <- rep( 0, n )
ind <- which( Types == "Cymbidium" )
Height[ind] <- height[1] + 0.2 * sqrt(Phospate[ind]) +
0.3 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.3 * (Temp[ind]-17) - 7 + rnorm( length(ind), sd=height[1]/10 )
ind <- which( Types == "Dendrobium" )
Height[ind] <- height[2] + 0.3 * sqrt(Phospate[ind]) +
0.35 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.4 * (Temp[ind]-17) - 10 +
rnorm( length(ind), sd=height[2]/10 )
##V8: Quality
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) ) +
0.15 * Height[ind]
ind <- which( Types == "Dendrobium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-01") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) )  +
0.05 * Height[ind]
ind <- rbinom( n, 1, 0.1 )
Quality[ind==1] <- 0
Orchids <- data.frame( "Type"=Types,
"Height"=round(Height,1),
"Quality"=round(Quality),
"Phosphate"=round(Phospate),
"Temperature"=round(Temp,1),
"Planting"=Date )
setwd("C:/Users/cr777/Desktop/Teaching 2024-2025/MA22019/Problem Sheets/Problem Sheet 2//")
write.csv( Orchids, "Orchids.csv", row.names = FALSE )
Orchids <- read.csv( "Orchids.csv" )
min(Orchids$Quality)
max(Orchids$Quality)
sum(Orchids$Quality>6)
Orchids <- read.csv( "Orchids.csv" )
ggplot( Orchids, aes(x=Phosphate, y=Height) ) + facet_wrap(~Type) +
geom_smooth()
Orchids$Quality  <- na_if( Orchids$Quality, 0 )
Orchids <- Orchids %>% mutate( Sell = as.numeric(Quality>6) )
Orchids %>%
group_by(Type) %>%
summarise( mean(Sell, na.rm=TRUE) )
Orchids$Planting <- as_date( Orchids$Planting )
ggplot( Orchids, aes(x=Phosphate, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
library(dplyr)
library(lubridate)
set.seed( 2022 )
n <- 3415
## V2: Phosphate Levels pmm
Phospate <- rgamma( n, shape=60, rate=0.75)
## V3: Date of planting
Date <- as_date("2024-03-01", format="%Y-%m-%d")
Date <- Date + round( 60 * rbeta(n, 2, 3 ) )
hist( Date, breaks=20 )
## V4: Type of plant
orchids <- c( "Cymbidium", "Dendrobium" )
Types <- sample( orchids, n, replace=T )
## V5: Temperature
Temp <- rep(0,n)
for( i in 1:n ){
Temp[i] <- case_when(
Types[i] == "Cymbidium" ~ 16.4 + 4.7 * rbeta(1,2,2),
Types[i] == "Dendrobium" ~ 17.5 + 5.2 * rbeta(1,2,2),
)
}
## V1: Orchid Height in inches
height <- c( 17, 30 )
Height <- rep( 0, n )
ind <- which( Types == "Cymbidium" )
Height[ind] <- height[1] + 0.2 * sqrt(Phospate[ind]) +
0.3 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.3 * (Temp[ind]-17) - 7 + rnorm( length(ind), sd=height[1]/10 )
ind <- which( Types == "Dendrobium" )
Height[ind] <- height[2] + 0.3 * sqrt(Phospate[ind]) +
0.35 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.4 * (Temp[ind]-17) - 10 +
rnorm( length(ind), sd=height[2]/10 )
##V8: Quality
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) ) +
0.15 * Height[ind]
ind <- which( Types == "Dendrobium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-01") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) )  +
0.05 * Height[ind]
ind <- rbinom( n, 1, 0.031 )
Quality[ind==1] <- 0
Orchids <- data.frame( "Type"=Types,
"Height"=round(Height,1),
"Quality"=round(Quality),
"Phosphate"=round(Phospate),
"Temperature"=round(Temp,1),
"Planting"=Date )
setwd("C:/Users/cr777/Desktop/Teaching 2024-2025/MA22019/Problem Sheets/Problem Sheet 2//")
write.csv( Orchids, "Orchids.csv", row.names = FALSE )
Orchids <- read.csv( "Orchids.csv" )
ggplot( Orchids, aes(x=Phosphate, y=Height) ) + facet_wrap(~Type) +
geom_smooth()
Orchids$Quality  <- na_if( Orchids$Quality, 0 )
Orchids <- Orchids %>% mutate( Sell = as.numeric(Quality>6) )
Orchids %>%
group_by(Type) %>%
summarise( mean(Sell, na.rm=TRUE) )
Orchids$Planting <- as_date( Orchids$Planting )
ggplot( Orchids, aes(x=Phosphate, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
ggplot( Orchids, aes(x=Planting, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
ggplot( Orchids, aes(x=Phosphate, y=Sell) ) + facet_wrap(~Type) +
geom_smooth()
min(Orchids$Planting)
max(Orchids$Planting)
Orchids <- read.csv( "Orchids.csv" )
glimpse(Orchids)
library(dplyr)
library(lubridate)
set.seed( 2022 )
n <- 3415
## V2: Phosphate Levels pmm
Phospate <- rgamma( n, shape=60, rate=0.75)
## V3: Date of planting
Date <- as_date("2024-03-01", format="%Y-%m-%d")
Date <- Date + round( 60 * rbeta(n, 2, 3 ) )
hist( Date, breaks=20 )
## V4: Type of plant
orchids <- c( "Cymbidium", "Dendrobium" )
Types <- sample( orchids, n, replace=T )
## V5: Temperature
Temp <- rep(0,n)
for( i in 1:n ){
Temp[i] <- case_when(
Types[i] == "Cymbidium" ~ 16.4 + 4.7 * rbeta(1,2,2),
Types[i] == "Dendrobium" ~ 17.5 + 5.2 * rbeta(1,2,2),
)
}
## V1: Orchid Height in inches
height <- c( 17, 30 )
Height <- rep( 0, n )
ind <- which( Types == "Cymbidium" )
Height[ind] <- height[1] + 0.2 * sqrt(Phospate[ind]) +
0.3 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.3 * (Temp[ind]-17) - 7 + rnorm( length(ind), sd=height[1]/10 )
ind <- which( Types == "Dendrobium" )
Height[ind] <- height[2] + 0.3 * sqrt(Phospate[ind]) +
0.35 * log( as.numeric(as_date("2024-10-15") - Date[ind]) ) +
0.4 * (Temp[ind]-17) - 10 +
rnorm( length(ind), sd=height[2]/10 )
##V8: Quality
Quality <- rep(0, n)
ind <- which( Types == "Cymbidium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-07") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) ) +
0.15 * Height[ind]
ind <- which( Types == "Dendrobium" )
Quality[ind] <-
round( 7 - 6/50 * abs (
as.numeric( as_date("2024-04-01") - Date[ind] ) +
round( runif( length(ind), -10, 10) ) ) ) +
round( runif( length(ind), -3, 0) )  +
0.05 * Height[ind]
Orchids <- data.frame( "Type"=Types,
"Height"=round(Height,1),
"Quality"=round(Quality),
"Phosphate"=round(Phospate),
"Temperature"=round(Temp,1),
"Planting"=Date )
setwd("C:/Users/cr777/Desktop/Teaching 2024-2025/MA22019/Problem Sheets/Problem Sheet 2//")
write.csv( Orchids, "Orchids.csv", row.names = FALSE )
Orchids <- read.csv( "Orchids.csv" )
min(Orchids$Quality)
max(Orchids$Quality)
Orchids <- read.csv( "Orchids.csv" )
ggplot( Orchids, aes("x"=Type, "y"=Height) ) + geom_boxplot() +
labs( "x"="Type of Ochid", "y" = "Height in inches")
ggplot( Orchids, aes("x"=Type, "y"=Height) ) + geom_boxplot() +
labs( "x"="Type of Ochid", "y" = "Height in inches" )
ggplot( Orchids, aes(x=Phosphate, y=Height) ) +
facet_wrap(~Type) + geom_point() + geom_smooth()
ggplot( Orchids, aes(x=Temperature, y=Height) ) +
facet_wrap(~Type) + geom_point() + geom_smooth()
Orchids <- read.csv( "Orchids.csv" )
ggplot( Orchids, aes("x"=Type, "y"=Height) ) + geom_boxplot() +
labs( "x"="Type of Ochid", "y" = "Height in inches" )
ggplot( Orchids, aes(x=Phosphate, y=Height) ) +
facet_wrap(~Type) + geom_point() + geom_smooth()
ggplot( Orchids, aes(x=Phosphate, y=Height) ) +
facet_wrap(~Type) + geom_point() + geom_smooth() +
labs( "x"="Level of Phosphate", "y" = "Height in inches" )
ggplot( Orchids, aes(x=Temperature, y=Height) ) +
facet_wrap(~Type) + geom_point() + geom_smooth() +
labs( "x"="Temperature", "y" = "Height in inches" )
Orchids <- Orchids %>%
mutate( Good = as.numeric(Quality>6) ) %>%
mutate( Planting = as_date( Planting, format="%d/%m/%Y" ) )
Orchids <- read.csv( "Orchids.csv" )
Orchids$Planting[1]
class(Orchids$Planting[1])
Orchids <- Orchids %>%
mutate( Good = as.numeric(Quality>6) ) %>%
mutate( Planting = as_date( Planting, format="%Y-%m-%d" ) )
ggplot( Orchids, aes( "x"=Planting, "y"=Good ) ) +
facet_wrap( ~Type ) + geom_smooth() +
labs( "x"="Date of planting", "y"="Proportion of good quality" )
ggplot( Orchids, aes( "x"=Planting, "y"=Good ) ) +
facet_wrap( ~Type ) + geom_smooth() +
labs( "x"="Date of planting", "y"="Proportion of good quality" )
min(Orchids$Quality)
