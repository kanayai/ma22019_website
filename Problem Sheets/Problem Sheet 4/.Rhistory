knitr::opts_chunk$set(echo = TRUE)
library( dplyr )
library( ggplot2 )
library( patchwork )
library( tidyr )
library( tidytext )
library( wordcloud )
library( stringr )
library( widyr )
library( topicmodels )
LesMis_raw <- read.csv( "LesMis.csv", fileEncoding="UTF-8" )
LesMis_chapter <- LesMis_raw %>%
mutate( chapter = cumsum( str_detect(
text, regex("^chapter ", ignore_case = TRUE)
) ) ) %>%
filter( chapter > 0 )
max(LesMis_chapter$chapter)
LesMis_raw$text[1:100]
LesMis_raw$text[1:300]
grep("THE SEVENTH CIRCLE AND THE EIGHTH HEAVEN", LesMis_raw )
?grep
grep(pattern="THE SEVENTH CIRCLE AND THE EIGHTH HEAVEN", x = LesMis_raw )
grep(pattern="EIGHTH HEAVEN", x = LesMis_raw )
LesMis_raw[932,]
LesMis_raw[332,]
LesMis_raw[322,]
LesMis_raw[200:300,]
LesMis_raw[300:400,]
LesMis_raw[400:500,]
grep( " CHAPTER I—THE SEVENTH CIRCLE AND THE EIGHTH HEAVEN", LesMis_raw$text)
grep( " CHAPTER I—THE SEVENTH CIRCLE AND THE EIGHTH HEAVEN", LesMis_raw$text)
LesMis_chapter <- LesMis_raw %>%
mutate( chapter = cumsum( str_detect(
text, regex("^chapter ", ignore_case = TRUE)
) ) ) %>%
filter( chapter > 0 )
LesMis_chapter[68882,]
dim(LesMis_chapter)
grep( "SEVENTH CIRCLE AND THE EIGHTH HEAVEN", LesMis_raw$text)
LesMis_chapter[50340,]
grep( "SEVENTH CIRCLE AND THE EIGHTH HEAVEN", LesMis_chapter$text)
LesMis_chapter[49815,]
LesMis_chapter[49814:49816,]
knitr::opts_chunk$set(echo = TRUE)
library( dplyr )
library( ggplot2 )
library( tidytext )
library( wordcloud )
library( stringr )
Poe_raw <- read.csv("Poe.csv")
Poe <- Poe_raw %>%
unnest_tokens( word, text ) %>%
mutate( word = gsub( "\\_", "", word ) )
Poe %>%
count( word, sort=TRUE ) %>%
slice_head(n=5)
data( stop_words )
Poe <- Poe %>% anti_join( stop_words, by="word" )
Poe %>%
group_by( story ) %>%
count( word, sort=TRUE ) %>%
slice_head( n=1 )
Poe %>%
group_by( story ) %>%
count( word, sort=TRUE ) %>%
slice_head( n=2 )
Poe %>%
group_by( story ) %>%
count( word, sort=TRUE ) %>%
slice_head( n=1 )
Poe %>%
group_by( story ) %>%
count( word, sort=TRUE ) %>%
slice_head( n=2 )
Poe %>%
group_by( story ) %>%
count( word, sort=TRUE ) %>%
slice_head( n=1 )
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/cr777/Desktop/Teaching 2024-2025/MA22019/Problem Sheets/Problem Sheet 4/Moodle Quiz/")
library(exams)
elearn_exam <- c( "Q1b.Rmd", "Q1c.Rmd")
set.seed(2025)
rxm <- exams2moodle( elearn_exam, n=1, name="PS4" )
Babies <- read.csv("Babynames.csv")
Babies %>%
group_by( name ) %>%
summarise( Count = sum(n) ) %>%
arrange( desc(Count) ) %>%
slice_head( n=1 )
Babies %>%
group_by( Name=name ) %>%
summarise( Count = sum(n) ) %>%
arrange( desc(Count) ) %>%
slice_head( n=1 )
Babies %>%
group_by( Name=name ) %>%
summarise( Count = sum(n) ) %>%
arrange( desc(Count) ) %>%
slice_head( n=4 )
Babies %>%
group_by( Name=name ) %>%
summarise( Count = sum(n) ) %>%
arrange( desc(Count) ) %>%
slice_head( n=10 )
Babies %>%
group_by( Name=name ) %>%
summarise( Count = sum(n) ) %>%
arrange( desc(Count) ) %>%
slice_head( n=1 )
Names_Girls <- Babies %>%
filter( sex=="F" ) %>%
group_by( name ) %>%
summarize( Count=sum(n) )
Names_Girls %>% with( wordcloud( name, Count, max.words=30 ) )
Names_Girls %>% with( wordcloud( name, Count, max.words=30 ) )
Babies %>%
filter( sex=="F", name=="Mary" ) %>%
ggplot( aes("x"=year, "y"=prop) ) + geom_line( linewidth=1 ) +
labs( x="Year", y="Proportion of newborn girls named Mary" ) + theme_bw()
Frankenstein_raw <- read.csv( "Frankenstein.csv", fileEncoding = "UTF-8" )
Frankenstein <- Frankenstein_raw %>% unnest_tokens( word, text )
Frankenstein <- Frankenstein %>% mutate( word = gsub( "_", "", word ) )
Frankenstein %>%
count( word, sort=TRUE ) %>%
anti_join( stop_words, by=c("word") ) %>%
slice_head( n=5 )
Frankenstein %>%
count( word, sort=TRUE ) %>%
anti_join( stop_words, by=c("word") ) %>%
slice_head( n=10 )
slice_min( Frankenstein_sentiment, sentiment, n=1 )
Frankenstein_chapters <- Frankenstein_raw %>%
mutate( chapter = cumsum( str_detect(
text, regex("^chapter ", ignore_case = TRUE)
) ) )
Frankenstein_chapters <- Frankenstein_chapters %>%
filter( chapter > 0 ) %>%
unnest_tokens( word, text ) %>%
mutate( word = gsub( "\\_", "", word ) )
AFINN <- get_sentiments( "afinn" )
AFINN <- get_sentiments( "afinn" )
Frankenstein_sentiment <- Frankenstein_chapters %>%
inner_join( AFINN, by="word" ) %>%
group_by( chapter ) %>%
summarise( sentiment = sum(value) )
slice_min( Frankenstein_sentiment, sentiment, n=1 )
slice_max( Frankenstein_sentiment, sentiment, n=1 )
Frankenstein_sentiment$sentiment
Frankenstein_sentiment
slice_min( Frankenstein_sentiment, sentiment, n=1 )
slice_max( Frankenstein_sentiment, sentiment, n=1 )
elearn_exam <- c( "Q1b.Rmd", "Q1c.Rmd",
"Q2a.Rmd", "Q2b.Rmd", "Q2c.Rmd",
"Q3a.Rmd", "Q3bi.Rmd", "Q3bii.Rmd" )
set.seed(2025)
rxm <- exams2moodle( elearn_exam, n=1, name="PS4" )
elearn_exam <- c( "Q1b.Rmd", "Q1c.Rmd",
"Q2a.Rmd", "Q2b.Rmd", "Q2c.Rmd",
"Q3a.Rmd", "Q3bi.Rmd", "Q3bii.Rmd" )
set.seed(2025)
rxm <- exams2moodle( elearn_exam, n=1, name="PS4" )
LesMis_raw <- read.csv( "LesMis.csv", fileEncoding="UTF-8" )
data( stop_words )
LesMis <- LesMis_raw %>%
unnest_tokens( word, text ) %>%
mutate( word = gsub( "\\_", "", word ) )  %>%
anti_join( stop_words, by="word" )
LesMis_Count <- LesMis %>% count( word, sort=TRUE )
LesMis_Count %>%
slice_head( n=10 ) %>%
mutate( word = reorder(word,n) ) %>%
ggplot( aes( x=n, y=word) ) + geom_col() +
theme_bw() + labs( x="Count", y="" ) +
theme( axis.text=element_text(size=17), axis.title=element_text(size=17) )
LesMis_Count %>% with( wordcloud( word, n, max.words=30 ) )
Reviews_raw <- read.csv( "AmazonReviews.csv" )
Reviews <- Reviews_raw %>% unnest_tokens( word, Text )
AFINN <- get_sentiments( "afinn" )
Reviews_Sentiment <- Reviews %>%
left_join( AFINN, by="word" ) %>%
mutate( value = case_when( is.na(value)==TRUE ~ 0, .default = value ) ) %>%
group_by( Review ) %>%
summarise( Sentiment=mean(value) )
Reviews_Sentiment <- Reviews_Sentiment %>% mutate( Score = Reviews_raw$Score )
ggplot( Reviews_Sentiment, aes(x=Score, y=Sentiment) ) +
geom_boxplot() + theme_bw() + labs( x="Star Rating", y="Sentiment Score")
Poe_raw <- read.csv("Poe.csv")
Poe_raw[1000,]
Poe_raw[2000,]
Poe_raw[3000,]
Poe_raw[4000,]
distinct( Poe_raw, story )
ind <- which( Poe_raw$story == "Four Beasts in one\u0097The Homo-Cameleopard" )
length(ind)
ind <- grep( pattern = "Four Beasts in one", x = Poe_raw$story  )
Poe_raw <- read.csv("Poe.csv")
distinct( Poe_raw, story )
Poe_raw <- read.csv("Poe.csv")
distinct( Poe_raw, story )
knitr::opts_chunk$set(echo = TRUE)
Time_raw <- read.csv( "Time Machine.csv" )
War_raw <- read.csv( "War of Worlds.csv" )
head(Time_raw)
