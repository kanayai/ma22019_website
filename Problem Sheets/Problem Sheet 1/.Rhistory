set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.005 * (Temp$Max[i]-5)^2 * (Temp$Max[i]>=0) * (Temp$Max[i]<5) +
0.25 * (Temp$Max[i]<0) +
0.01 * (Temp$Max[i]-25)^2 * ( Temp$Max[i]>25 ) * (Temp$Max[i]<=30) +
0.25 * ( Temp$Max[i]>30 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
library(ggplot2)
library(patchwork)
set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.003 * (Temp$Max[i]-5)^2 * (Temp$Max[i]>=0) * (Temp$Max[i]<5) +
0.10 * (Temp$Max[i]<0) +
0.01 * (Temp$Max[i]-25)^2 * ( Temp$Max[i]>25 ) * (Temp$Max[i]<=30) +
0.25 * ( Temp$Max[i]>30 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
library(ggplot2)
library(patchwork)
set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.003 * (Temp$Max[i]-5)^2 * (Temp$Max[i]>=0) * (Temp$Max[i]<5) +
0.10 * (Temp$Max[i]<0) +
0.005 * (Temp$Max[i]-25)^2 * ( Temp$Max[i]>25 ) * (Temp$Max[i]<=30) +
0.125 * ( Temp$Max[i]>30 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
0.005 * 15^2
0.0025 * 15^2
library(ggplot2)
library(patchwork)
set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.003 * (Temp$Max[i]-5)^2 * (Temp$Max[i]>=0) * (Temp$Max[i]<5) +
0.10 * (Temp$Max[i]<0) +
0.0025 * (Temp$Max[i]-25)^2 * ( Temp$Max[i]>25 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
library(ggplot2)
library(patchwork)
set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.003 * (Temp$Max[i]-5)^2 * (Temp$Max[i]>=0) * (Temp$Max[i]<5) +
0.10 * (Temp$Max[i]<0) +
0.0025 * (Temp$Max[i]-25)^1.5 * ( Temp$Max[i]>25 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
library(ggplot2)
library(patchwork)
set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.003 * (Temp$Max[i]-5)^2 * (Temp$Max[i]>=0) * (Temp$Max[i]<5) +
0.10 * (Temp$Max[i]<0) +
0.0025 * (Temp$Max[i]-25)^2 * ( Temp$Max[i]>25 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
library(ggplot2)
library(patchwork)
set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.003 * (Temp$Max[i]-5)^2 * (Temp$Max[i]>=0) * (Temp$Max[i]<5) +
0.10 * (Temp$Max[i]<0) +
0.0025 * sqrt((Temp$Max[i]-25)^3) * ( Temp$Max[i]>25 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
library(ggplot2)
library(patchwork)
set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.003 * (Temp$Max[i]-5)^2 * (Temp$Max[i]>=0) * (Temp$Max[i]<5) +
0.10 * (Temp$Max[i]<0) +
0.002 * (Temp$Max[i]-25)^2 * ( Temp$Max[i]>25 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
library(ggplot2)
library(patchwork)
set.seed(17837783)
Cases <- data.frame( Date=Temp$Date, Temperature=Temp$Max, Number=0 )
for( i in 1:length(Temp$Date) ){
temp <- filter( Pets, Year==year(Temp$Date[i]), Month==month(Temp$Date[i]) )
prop <- -7.7 +
0.002 * (Temp$Max[i]-5) * (Temp$Max[i]>5) +
0.001 * (Temp$Max[i]+5) * (Temp$Max[i]< -5) +
0.001 * (Temp$Max[i]-5)^2 * (Temp$Max[i]<5) +
0.002 * (Temp$Max[i]-25)^2 * ( Temp$Max[i]>25 )
prop <- exp( prop ) * ( 1 + exp(prop) )
Cases$Number[i] <- rbinom( 1, size = temp$Maltese, prop)
}
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_point() +
ggplot( Cases, aes(x=Temperature, y=Number) ) + geom_smooth()
write.csv( x = Cases, file = "Cases.csv", row.names = FALSE )
knitr::opts_chunk$set(echo = TRUE)
Maltese <- Pets %>% select( Year, Month, Maltese )
Cases <- Cases %>%
mutate( Year= year(Date), Month=month(Date) ) %>%
full_join( Pets, Maltese, by=c("Year"="Year", "Month"="Month" ) )
head(Cases)
Pets  <- read.csv( "Pets.csv", header = TRUE )
Cases <- read.csv( "Cases.csv", header=TRUE )
Maltese <- Pets %>% select( Year, Month, Maltese )
Cases <- Cases %>%
mutate( Year= year(Date), Month=month(Date) ) %>%
full_join( Maltese, by=c("Year"="Year", "Month"="Month" ) )
head(Cases)
ggplot( Cases, aes(x=Temperature, y=Proportion) ) +
geom_point() + geom_smooth() +
labs( y="Proportion of dogs with respiratory issues" )
Pets  <- read.csv( "Pets.csv", header = TRUE )
Cases <- read.csv( "Cases.csv", header=TRUE )
Maltese <- Pets %>% select( Year, Month, Maltese )
Cases <- Cases %>%
mutate( Year= year(Date), Month=month(Date) ) %>%
full_join( Maltese, by=c("Year"="Year", "Month"="Month" ) ) %>%
mutate( Proportion = Number / Maltese )
ggplot( Cases, aes(x=Temperature, y=Proportion) ) +
geom_point() + geom_smooth() +
labs( y="Proportion of dogs with respiratory issues" )
MaltesePhysio <- read.csv( "Maltese.csv" )
ggplot( MaltesePhysio, aes( x=Age, y=RespiratoryIssues ) ) + geom_smmoth()
ggplot( MaltesePhysio, aes( x=Age, y=RespiratoryIssues ) ) + geom_smooth()
ggplot( MaltesePhysio, aes( x=Age, y=RespiratoryIssues ) ) +
geom_point() + geom_smooth()
ggplot( MaltesePhysio, aes( x=Age, y=RespiratoryIssues ) ) + geom_smooth()
ggplot( MaltesePhysio, aes( x=Age, y=RespiratoryIssues ) ) +
geom_rug() + geom_smooth()
ggplot( MaltesePhysio, aes( x=Age, y=RespiratoryIssues ) ) +
geom_smooth()
ggplot( MaltesePhysio, aes( x=Age, y=RespiratoryIssues ) ) +
geom_smooth()
knitr::opts_chunk$set(echo = TRUE)
ggplot( MaltesePhysio, aes( x=Weight/Height^2, y=RespiratoryIssues ) ) +
geom_smooth() + theme( axis.title = element_text(size = 15) )
library(ggplot2)
MaltesePhysio <- read.csv( "Maltese.csv" )
ggplot( MaltesePhysio, aes( x=Weight/Height^2, y=RespiratoryIssues ) ) +
geom_smooth() + theme( axis.title = element_text(size = 15) )
ggplot( MaltesePhysio, aes( x=Weight, y=RespiratoryIssues ) ) +
geom_smooth() + theme( axis.title = element_text(size = 15) ) +
ggplot( MaltesePhysio, aes( x=Height, y=RespiratoryIssues ) ) +
geom_smooth() + theme( axis.title = element_text(size = 15) )
library(patchwork)
ggplot( MaltesePhysio, aes( x=Weight, y=RespiratoryIssues ) ) +
geom_smooth() + theme( axis.title = element_text(size = 15) ) +
ggplot( MaltesePhysio, aes( x=Height, y=RespiratoryIssues ) ) +
geom_smooth() + theme( axis.title = element_text(size = 15) )
ggplot( MaltesePhysio, aes( x=Weight/Height, y=RespiratoryIssues ) ) +
geom_smooth() + theme( axis.title = element_text(size = 15) )
ggplot( MaltesePhysio, aes( x=Weight/Height^2, y=RespiratoryIssues ) ) +
geom_smooth() + theme( axis.title = element_text(size = 15) )
knitr::opts_chunk$set(echo = TRUE)
prop <- data.frame( "Heating" = c(20,20,20,13,7,3,2,2,4,10,15,19),
"Cooking" = c(6,6,5,4,4,4,4,4,4,5,7,7),
"Electrical" = c(6,6,5,4,3,3,3,3,3,4,6,7),
"Others" = c(10,8,7,7,6,8,8,9,8,7,7,9) )
prop <- prop / apply( prop, 1,sum )
prop
set.seed(2023)
prop <- data.frame( "Heating" = c(20,20,20,13,7,3,2,2,4,10,15,19),
"Cooking" = c(6,6,5,4,4,4,4,4,4,5,7,7),
"Electrical" = c(6,6,5,4,3,3,3,3,3,4,6,7),
"Others" = c(10,8,7,7,6,8,8,9,8,7,7,9) )
prop <- prop / apply( prop, 1,sum )
rate_Month <- c( 231,213,198,187,165,160,145,153,179,201,227,276 )
num_Month  <- rpois( 12, lambda=rate_Month )
sum(num_Month)
set.seed(2023)
prop <- data.frame( "Heating" = c(20,20,20,13,7,3,2,2,4,10,15,19),
"Cooking" = c(6,6,5,4,4,4,4,4,4,5,7,7),
"Electrical" = c(6,6,5,4,3,3,3,3,3,4,6,7),
"Others" = c(10,8,7,7,6,8,8,9,8,7,7,9) )
prop <- prop / apply( prop, 1,sum )
rate_Month <- c( 3231,3113,2898,2687,2465,2160,2145,2153,2579,2901,3227,3776 )
num_Month  <- rpois( 12, lambda=rate_Month )
sum(num_Month)
z <- rbinom(10000, 1, 0.3 )
y <- z*rbeta(10000, 1,2 ) + (1-z) * rbeta(10000, 3, 1 )
hist(y)
hist(rbeta( 10000, 3,1) )
hist(rbeta( 10000, 6,2) )
y <- z*rbeta(10000, 2,4 ) + (1-z) * rbeta(10000, 6, 2 )
hist(y)
y <- z*rbeta(10000, 2,4 ) + (1-z) * rbeta(10000, 9, 3 )
hist(y)
y <- z*rbeta(10000, 3,6 ) + (1-z) * rbeta(10000, 6, 2 )
hist(y)
i <- 1
cause <- "Heating"
prop_day <- data.frame(
"Heating" = c(3,2,3,7,6,4,5,6,8,9,8,4),
"Cooking" = c(1,1,1,8,6,7,7,3,6,7,4,1),
"Electrical" = c(2,2,2,3,3,3,3,3,3,3,2,2),
"Others" = c(1,1,3,4,5,5,6,5,5,4,4,3,2)
)
prop_day <- data.frame(
"Heating" = c(3,2,3,7,6,4,5,6,8,9,8,4),
"Cooking" = c(1,1,1,8,6,7,7,3,6,7,4,1),
"Electrical" = c(2,2,2,3,3,3,3,3,3,3,2,2),
"Others" = c(1,1,3,4,5,5,6,5,4,4,3,2)
)
day_i <- 0
if( i==2 )
day_i <- sample( x=1:28, size=1 )
else if( i==4 || i==6 || i==9 || i==11 )
day_i <- 0
if( i==2 ) {
day_i <- sample( x=1:28, size=1 )
} else if( i==4 || i==6 || i==9 || i==11 ) {
day_i <- sample( x=1:30, size=1 )
} else
day_i <- sample( x=1:31, size=1 )
minute_i <- sample( x=0:59, size=1 )
hour_i <- c()
hour_i
minute_i
day_i
hour_i <- 2 * sample( x=1:12, size=1, prop_day$Heating ) -
2 + rbinom( 1, 1, 0.5 )
2 * sample( x=1:12, size=1, prop_day$Heating )
2 * sample( x=1:12, size=1, prob=prop_day$Heating )
paste( paste(2022,i,day_i),sep="-",
paste(hour_i, ":", minute_i, sep="" ), sep="" )
paste( paste(2022,i,day_i ,sep="-") ,
paste(hour_i, ":", minute_i, sep="" ), sep="" )
paste(2022,i,day_i ,sep="-")
paste(hour_i, ":", minute_i, sep="" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Heating ) -
2 + rbinom( 1, 1, 0.5 )
paste( paste(2022,i,day_i ,sep="-") ,
paste(hour_i, ":", minute_i, sep="" ), sep="" )
paste( paste(2022,i,day_i ,sep="-") ,
paste(hour_i, ":", minute_i, sep="" ), sep=" " )
date_i <- paste( paste(2022,i,day_i ,sep="-") ,
paste(hour_i, ":", minute_i, sep="" ), sep=" " )
lubridate::ymd_hm(date_i)
set.seed(2023)
prop <- data.frame( "Heating" = c(20,20,20,13,7,3,2,2,4,10,15,19),
"Cooking" = c(6,6,5,4,4,4,4,4,4,5,7,7),
"Electrical" = c(6,6,5,4,3,3,3,3,3,4,6,7),
"Others" = c(10,8,7,7,6,8,8,9,8,7,7,9) )
prop <- prop / apply( prop, 1,sum )
rate_Month <- c( 3231,3113,2898,2687,2465,2160,2145,2153,2579,2901,3227,3776 )
num_Month  <- rpois( 12, lambda=rate_Month )
prop_day <- data.frame(
"Heating" = c(3,2,3,7,6,4,5,6,8,9,8,4),
"Cooking" = c(1,1,1,8,6,7,7,3,6,7,4,1),
"Electrical" = c(2,2,2,3,3,3,3,3,3,3,2,2),
"Others" = c(1,1,3,4,5,5,6,5,4,4,3,2)
)
sample_Date <- function( i, cause ){
day_i <- 0
if( i==2 ) {
day_i <- sample( x=1:28, size=1 )
} else if( i==4 || i==6 || i==9 || i==11 ) {
day_i <- sample( x=1:30, size=1 )
} else
day_i <- sample( x=1:31, size=1 )
minute_i <- sample( x=0:59, size=1 )
hour_i <- c()
if( cause == "Heating" ){
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Heating ) -
2 + rbinom( 1, 1, 0.5 )
else if( cause=="Cooking" )
prop_day <- data.frame(
"Heating" = c(3,2,3,7,6,4,5,6,8,9,8,4),
"Cooking" = c(1,1,1,8,6,7,7,3,6,7,4,1),
"Electrical" = c(2,2,2,3,3,3,3,3,3,3,2,2),
"Others" = c(1,1,3,4,5,5,6,5,4,4,3,2)
)
sample_Date <- function( i, cause ){
day_i <- 0
if( i==2 ) {
day_i <- sample( x=1:28, size=1 )
} else if( i==4 || i==6 || i==9 || i==11 ) {
day_i <- sample( x=1:30, size=1 )
} else
day_i <- sample( x=1:31, size=1 )
minute_i <- sample( x=0:59, size=1 )
hour_i <- c()
if( cause == "Heating" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Heating ) -
2 + rbinom( 1, 1, 0.5 )
else if( cause=="Cooking" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Cooking ) -
2 + rbinom( 1, 1, 0.5 )
else if( cause=="Electrical Fault" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Electrical ) -
2 + rbinom( 1, 1, 0.5 )
else
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Other ) -
2 + rbinom( 1, 1, 0.5 )
}
date_i <- paste( paste(2022,i,day_i ,sep="-") ,
paste(hour_i, ":", minute_i, sep="" ), sep=" " )
}
prop_day <- data.frame(
"Heating" = c(3,2,3,7,6,4,5,6,8,9,8,4),
"Cooking" = c(1,1,1,8,6,7,7,3,6,7,4,1),
"Electrical" = c(2,2,2,3,3,3,3,3,3,3,2,2),
"Others" = c(1,1,3,4,5,5,6,5,4,4,3,2)
)
sample_Date <- function( i, cause ){
day_i <- 0
if( i==2 ) {
day_i <- sample( x=1:28, size=1 )
} else if( i==4 || i==6 || i==9 || i==11 ) {
day_i <- sample( x=1:30, size=1 )
} else
day_i <- sample( x=1:31, size=1 )
minute_i <- sample( x=0:59, size=1 )
hour_i <- c()
if( cause == "Heating" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Heating ) -
2 + rbinom( 1, 1, 0.5 )
else if( cause=="Cooking" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Cooking ) -
2 + rbinom( 1, 1, 0.5 )
else if( cause=="Electrical Fault" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Electrical ) -
2 + rbinom( 1, 1, 0.5 )
else
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Other ) -
2 + rbinom( 1, 1, 0.5 )
date_i <- paste( paste(2022,i,day_i ,sep="-") ,
paste(hour_i, ":", minute_i, sep="" ), sep=" " )
}
Date  <- c()
Cause <- c()
set.seed( 2023 )
for( i in 1:12 ){
Cause_i <- sample( x=c("Heating","Cooking","Electrical Fault","Other"),
size=num_Month[i], prob = prop[i,], replace = TRUE )
Date_i <- rep( "", num_Month[i] )
for( j in 1:length(Cause_i) )
Date_i[j] <- sample_Date( i, Cause_i[j] )
Date <- c( Date, Date_i )
Cause <- c( Cause, Cause_i )
}
plot( Date )
min(Date)
max(Date)
max( lubridate::month(Date) )
hist( lubridate::month(Date) )
prop_day <- data.frame(
"Heating" = c(3,2,3,7,6,4,5,6,8,9,8,4),
"Cooking" = c(1,1,1,8,6,7,7,3,6,7,4,1),
"Electrical" = c(2,2,2,3,3,3,3,3,3,3,2,2),
"Others" = c(1,1,3,4,5,5,6,5,4,4,3,2)
)
sample_Date <- function( i, cause ){
day_i <- 0
if( i==2 ) {
day_i <- sample( x=1:28, size=1 )
} else if( i==4 || i==6 || i==9 || i==11 ) {
day_i <- sample( x=1:30, size=1 )
} else
day_i <- sample( x=1:31, size=1 )
minute_i <- sample( x=0:59, size=1 )
hour_i <- c()
if( cause == "Heating" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Heating ) -
2 + rbinom( 1, 1, 0.5 )
else if( cause=="Cooking" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Cooking ) -
2 + rbinom( 1, 1, 0.5 )
else if( cause=="Electrical Fault" )
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Electrical ) -
2 + rbinom( 1, 1, 0.5 )
else
hour_i <- 2 * sample( x=1:12, size=1, prob=prop_day$Other ) -
2 + rbinom( 1, 1, 0.5 )
date_i <- paste( paste(2022,i,day_i ,sep="-") ,
paste(hour_i, ":", minute_i, sep="" ), sep=" " )
}
Date  <- c()
Cause <- c()
set.seed( 2023 )
for( i in 1:12 ){
Cause_i <- sample( x=c("Heating","Cooking","Electrical Fault","Other"),
size=num_Month[i], prob = prop[i,], replace = TRUE )
Date_i <- rep( "", num_Month[i] )
for( j in 1:length(Cause_i) )
Date_i[j] <- sample_Date( i, Cause_i[j] )
Date <- c( Date, Date_i )
Cause <- c( Cause, Cause_i )
}
Fires <- data.frame( "Date"=Date, "Cause"=Cause)
library(ggplot2)
library(lubridate)
library(dplyr)
ggplot( Fires, aes(x=hour(Date) ) ) + facet_wrap(~Cause) +
geom_histogram() + coord_polar()
ggplot( Fires, aes(x=hour(Date) ) ) + facet_wrap(~Cause) +
geom_histogram(bins=24) + coord_polar()
ggplot( Fires, aes(x=hour(Date) ) ) + facet_wrap(~Cause, , scales="free") +
geom_histogram(bins=24) + coord_polar()
ggplot( Fires, aes(x=hour(Date) ) ) + facet_wrap(~Cause, scales="free") +
geom_histogram(bins=24) + coord_polar()
ggplot( Fires, aes(x=hour(Date) ) ) + facet_wrap(~Cause, scales="free_y") +
geom_histogram(bins=24) + coord_polar()
ggplot( Fires, aes(x=hour(Date) ) ) + facet_wrap(~Cause, scales="free_x") +
geom_histogram(bins=24) + coord_polar()
ggplot( Fires, aes(x=hour(Date) ) ) + facet_wrap(~Cause) +
geom_histogram(bins=24) + coord_polar()
ggplot( Fires, aes(x=day(Date) ) ) + facet_wrap(~Cause) +
geom_histogram(bins=24) + coord_polar()
knitr::opts_chunk$set(echo = TRUE)
NCES_raw <- read.csv( "College Costs.csv", header= TRUE )
glimpse( NCES_raw )
NCES <- NCES_raw %>% filter( Length=="4-year", Expense=="Fees/Tuition" )
plot( NCES$Value[Year==2013], NCES$Value[Year==2014] )
plot( NCES$Value[NCES$Year==2013], NCES$Value[NCES$Year==2014] )
abline(0,1)
NCES %>% filter( Type=="Public In-State") %>% group_by(State) %>% arrange( Value ) %>% slice_head(n=1)
setwd("C:/Users/cr777/Desktop/Teaching 2023-2024/MA20277/Problem Sheets/Problem Sheet 1/")
#1a)
sdata<-read.csv("Satellites.csv")
sdata2<-sdata %>% filter(Launched.in<2024)
#1b)
barplot(table(factor(sdata2$Launched.in,levels=1972:2023)),
xlab="Years",ylab="Number of Satellites",main="Satellites launched per year")
#1c)
sdata3<-sdata %>% filter(Launched.in<2022 & (is.na(Out.of.service.since)|Out.of.service.since>2022) ) %>%
count( Organisation, sort=TRUE )
sdata3[1:5,] #Here are the top 5 results
#1c)
sdata3<-sdata %>% filter(Launched.in<=2022 & (is.na(Out.of.service.since)|Out.of.service.since>2022) ) %>%
count( Organisation, sort=TRUE )
sdata3[1:5,] #Here are the top 5 results
#QUESTION 3:
#3a
cdata<-read.csv("College Costs.csv")
cdata %>%
group_by( Year ) %>% filter(Expense=="Fees/Tuition" & Type=="Private") %>%
summarize( "Number"=n(), "Average"=mean(Value) )
#3b
cdata2<-cdata %>% filter(Year=="2013" | Year=="2020") %>%
filter(Type=="Public Out-of-State", Expense=="Fees/Tuition") %>%
group_by(State,Length) %>%
summarize(max_difference = max(Value)-min(Value)) %>%
mutate(max_difference_per_year = ifelse(Length == '2-year', max_difference / 2, max_difference / 4)) %>%
arrange(desc(max_difference_per_year))
cdata2[1:5,]
#3c
cdata3<-cdata%>% filter(Year=="2013",Type=="Public Out-of-State", Expense=="Fees/Tuition")%>%
mutate(Value_per_year = ifelse(Length == '2-year', Value / 2, Value / 4))%>%
arrange(desc(Value_per_year))
cdata3[1:5,]
