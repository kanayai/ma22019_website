knitr::opts_chunk$set(echo = TRUE)
ggplot( Pets, aes("x"=Date) ) +
geom_line( aes( "y"=Dogs, color="Dogs" ) ) +
geom_line( aes( "y"=Cats, color="Cats") ) +
labs( x="Year", y="Number" ) +
scale_colour_manual( name="Pet", values=c("Dogs","Cats") )
library(dplyr)
library(lubridate)
library(ggplot2)
library(patchwork)
Pets <- read.csv("Pets.csv")
glimpse( Pets )
Pets <- Pets %>%
mutate( Date = paste( Year, Month, sep="-" ) ) %>%
mutate( Date = ym( Date ) )
Pets <- Pets %>% mutate( Dogs = Beagles + Dachshund + Maltese )
ggplot( Pets, aes("x"=Date) ) +
geom_line( aes( "y"=Dogs, color="Dogs" ) ) +
geom_line( aes( "y"=Cats, color="Cats") ) +
labs( x="Year", y="Number" ) +
scale_colour_manual( name="Pet", values=c("Dogs","Cats") )
ggplot( Pets, aes("x"=Date) ) +
geom_line( aes( "y"=Dogs, color="Dogs" ) ) +
geom_line( aes( "y"=Cats, color="Cats"), linetype=4 ) +
labs( x="Year", y="Number" ) +
scale_colour_manual( name="Pet", values=c("Dogs"="red","Cats"="blue") )
ggplot( Pets, aes("x"=Date) ) +
geom_line( aes( "y"=Dogs, color="Dogs" ) ) +
geom_line( aes( "y"=Cats, color="Cats"), linetype=2 ) +
labs( x="Year", y="Number" ) +
scale_colour_manual( name="Pet", values=c("Dogs"="red","Cats"="blue") )
knitr::opts_chunk$set(echo = TRUE)
CO2 <- read.csv( "CO2 Emissions.csv", header=TRUE )
glimpse(CO2)
CO2 <- read.csv( "CO2 Emissions.csv", header=TRUE )
CO2 %>%
group_by( country ) %>%
summarize( Total=sum( emissions) ) %>%
arrange( desc(Total) ) %>%
slice_head( n=5 )
CO2_UK <- CO2 %>%
filter( country=="UK" ) %>%
group_by( sector ) %>%
summarize( Total=sum(emissions) )
ggplot( CO2_UK, aes( x="", y=Total, fill=sector ) ) +
geom_col() + coord_polar( theta="y" ) +
labs( x="", y="Emissions" ) +
theme( axis.title=element_text(size=15),
axis.text=element_text(size=13),
legend.title=element_text(size=15),
legend.text=element_text(size=13) )
ggplot( CO2_UK, aes( x="", y=Total, fill=sector ) ) +
geom_col() + coord_polar( theta="y" ) +
labs( x="", y="Emissions" )
CO2_UK <- CO2 %>%
filter( country=="UK" ) %>%
group_by( sector ) %>%
summarize( Total=sum(emissions) )
CO2_UK
Traffic <- read.csv( "Traffic Minnesota.csv" )
glimpse(Traffic)
Traffic <- Traffic %>% mutate( date_time = datetime(date_time) )
Traffic <- Traffic %>% mutate( date_time = as_datetime(date_time) )
Traffic <- Traffic %>% mutate( Weekday = weekdays(date_time) )
glimpse(Traffic)
Traffic <- Traffic %>% mutate( date_time = dmy_hm(date_time) )
Traffic <- Traffic %>% mutate( Weekday = weekdays(date_time) )
Traffic <- read.csv( "Traffic Minnesota.csv" )
Traffic <- Traffic %>% mutate( Date = dmy_hm(date_time) )
Traffic <- Traffic %>% mutate( Weekday = weekdays(date_time) )
Traffic <- Traffic %>% mutate( Date = dmy_hm(date_time) )
Traffic <- Traffic %>% mutate( Weekday = weekdays(Date) )
glimpse(Traffic)
Traffic %>%
filter( Weekday=="Saturday" ) %>%
summarize( Average = mean(traffic_volume) )
Traffic <- Traffic %>%
mutate( WorkDay = case_when( Weekday == "Saturday" ~ "Weekend",
Weekday == "Sunday" ~ "Weekend",
holiday != "None" ~ "Weekend",
.default = "Workday" ) )
Traffic %>%
group_by( WorkDay ) %>%
summarise( Mean = mean(traffic_volume) )
AverageTraffic <- Traffic %>%
group_by( WorkDay ) %>%
summarise( Mean = mean(traffic_volume) )
AverageTraffic$Mean[1] - AverageTraffic$Mean[2]
BrisbaneGoldCoast <- read.csv("BrisbaneGoldCoast.csv")
BrisbaneGoldCoast <- BrisbaneGoldCoast %>%
mutate( Date = as_date( Date, format="%d/%m/%Y" ) )
GoldCoast <- filter( BrisbaneGoldCoast, Location=="GoldCoast" )
GoldCoast <- filter( BrisbaneGoldCoast, Location=="GoldCoast" )
g1 <- ggplot( GoldCoast, aes( x=Date, y=MaxTemp ) ) +
geom_line( ) + labs( x="Date", y="Maximum Temperature" )
g2 <- ggplot( GoldCoast, aes( x=yday(Date), y=MaxTemp ) ) +
geom_point() + geom_smooth( ) + labs( x="Day of the Year", y="Maximum Temperature" )
g1 + g2
BGC_wide <- pivot_wider( BrisbaneGoldCoast, names_from=Location,
values_from=MaxTemp:WindGustSpeed )
library(dplyr)
library(lubridate)
library(ggplot2)
library(patchwork)
library(tidyr)
BGC_wide <- pivot_wider( BrisbaneGoldCoast, names_from=Location,
values_from=MaxTemp:WindGustSpeed )
ggplot( BGC_wide, aes(x=MaxTemp_Brisbane, y=MaxTemp_GoldCoast) ) +
geom_point() +
labs( x="Maximum Brisbane", y="Maximum Gold Coast" )
CO2 <- read.csv( "CO2 Emissions.csv", header=TRUE )
distinct( CO2, country )
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/cr777/Desktop/Teaching 2024-2025/MA22019/Problem Sheets/Problem Sheet 3/Moodle Quiz/")
library(exams)
elearn_exam <- c("Q1a.Rmd", "Q1b.Rmd", "Q1c.Rmd",
"Q1d.Rmd", "Q1e.Rmd", "Q1f.Rmd",
"Q2a.Rmd", "Q2b.Rmd", "Q2c.Rmd",
"Q2d.Rmd", "Q3a.Rmd", "Q3b.Rmd")
Traffic %>%
filter( Weekday=="Saturday" ) %>%
summarize( Average = mean(traffic_volume) )
Traffic <- read.csv( "Traffic Minnesota.csv" )
Traffic <- Traffic %>% mutate( date_time = dmy_hm(date_time) )
Traffic <- Traffic %>% mutate( Weekday = weekdays(date_time) )
Traffic %>%
filter( Weekday=="Saturday" ) %>%
summarize( Average = mean(traffic_volume) )
AverageTraffic$Mean[1] - AverageTraffic$Mean[2]
Traffic <- Traffic %>%
filter( Weekday = ="Monday" ) %>%
Traffic <- Traffic %>%
filter( Weekday == "Monday" ) %>%
ggplot( aes(x=hour(date_time), y=traffic_volume) ) +
geom_point() + geom_smooth() +
labs( x="Hour of the Day", y="Traffic Volume" )
Traffic <- read.csv( "Traffic Minnesota.csv" )
Traffic <- Traffic %>% mutate( date_time = dmy_hm(date_time) )
Traffic <- Traffic %>% mutate( Weekday = weekdays(date_time) )
Traffic %>%
filter( Weekday=="Saturday" ) %>%
summarize( Average = mean(traffic_volume) )
Traffic <- Traffic %>%
mutate( WorkDay = case_when( Weekday == "Saturday" ~ "Weekend",
Weekday == "Sunday" ~ "Weekend",
holiday != "None" ~ "Weekend",
.default = "Workday" ) )
AverageTraffic <- Traffic %>%
group_by( WorkDay ) %>%
summarise( Mean = mean(traffic_volume) )
AverageTraffic$Mean[1] - AverageTraffic$Mean[2]
Traffic %>%
filter( Weekday == "Monday" ) %>%
ggplot( aes(x=hour(date_time), y=traffic_volume) ) +
geom_point() + geom_smooth() +
labs( x="Hour of the Day", y="Traffic Volume" )
BrisbaneGoldCoast <- read.csv("BrisbaneGoldCoast.csv")
BrisbaneGoldCoast <- BrisbaneGoldCoast %>%
mutate( Date = as_date( Date, format="%d/%m/%Y" ) )
GoldCoast <- filter( BrisbaneGoldCoast, Location=="GoldCoast" )
g1 <- ggplot( GoldCoast, aes( x=Date, y=MaxTemp ) ) +
geom_line( ) + labs( x="Date", y="Maximum Temperature" )
g2 <- ggplot( GoldCoast, aes( x=yday(Date), y=MaxTemp ) ) +
geom_point() + geom_smooth( ) + labs( x="Day of the Year", y="Maximum Temperature" )
g1 + g2
GoldCoast %>% group_by(month(Date)) %>% summarise( Mean=mean(MaxTemp) )
GoldCoast %>% group_by(month(Date)) %>% summarise( Mean=mean(MaxTemp, na.rm=TRUE) )
setwd("C:/Users/cr777/Desktop/Teaching 2024-2025/MA22019/Problem Sheets/Problem Sheet 3/Moodle Quiz/")
elearn_exam <- c( "Q1a.Rmd", "Q1b.Rmd", "Q2bi.Rmd",
"Q2bii.Rmd", "Q3ai.Rmd", "Q3aii.Rmd")
set.seed(2025)
rxm <- exams2moodle( elearn_exam, n=1, name="PS3" )
set.seed(2025)
rxm <- exams2moodle( elearn_exam, n=1, name="PS3" )
elearn_exam <- c( "Q1a.Rmd", "Q1b.Rmd", "Q2bi.Rmd",
"Q2bii.Rmd", "Q3ai.Rmd", "Q3aii.Rmd")
set.seed(2025)
rxm <- exams2moodle( elearn_exam, n=1, name="PS3" )
elearn_exam <- c( "Q1a.Rmd", "Q1b.Rmd", "Q2bi.Rmd",
"Q2bii.Rmd", "Q3ai.Rmd", "Q3aii.Rmd")
set.seed(2025)
rxm <- exams2moodle( elearn_exam, n=1, name="PS3" )
