for( i in 1:20 )
for( j in 1:20 )
Gamma_estim[i,j] <- mean( (Temp_PCA[,i] - Temp_PCA[,j])^2 )
Gamma_estim <- matrix(0,20,20)
for( i in 1:20 )
for( j in 1:20 )
Gamma_estim[i,j] <- mean( (Temp_PCA[,i] - Temp_PCA[,j])^2, na.rm = TRUE )
Temp_PCA[,i]
dim(Temp_PCA)
Gamma_estim <- matrix(0,20,20)
for( i in 1:20 ){
for( j in 1:20 ){
Gamma_estim[i,j] <- mean( (Temp_PCA[,i] - Temp_PCA[,j])^2, na.rm = TRUE )
}
}
i
j
Temp_PCA[,i] - Temp_PCA[,j]
(Temp_PCA[,i] - Temp_PCA[,j])^2
mean( (Temp_PCA[,i] - Temp_PCA[,j])^2, na.rm = TRUE )
sum((Temp_PCA[,i] - Temp_PCA[,j])^2)
mean((Temp_PCA[,i] - Temp_PCA[,j])^2)
class((Temp_PCA[,i] - Temp_PCA[,j])^2)
mean(((Temp_PCA[,i] - Temp_PCA[,j])^2)[,1])
Gamma_estim <- matrix(0,20,20)
for( i in 1:20 ){
for( j in 1:20 ){
Gamma_estim[i,j] <- mean(((Temp_PCA[,i] - Temp_PCA[,j])^2)[,1], na.rm = TRUE)
}
}
library(lattice)
levelplot(lattice)
levelplot(Gamma_estim)
plot(Temp_PCA$Sylt, Temp_PCA$Arkona)
j
i <- 10
mean(((Temp_PCA[,i] - Temp_PCA[,j])^2)[,1], na.rm = TRUE)
plot(Temp_PCA$Sylt, Temp_PCA$Arkona)
cor(Temp_PCA$Sylt, Temp_PCA$Arkona)
Temp_PCA[,i]
Temp_PCA[,i]
Gamma_estim <- matrix(0,20,20)
for( i in 1:20 ){
for( j in 1:20 ){
Gamma_estim[i,j] <- mean(((Temp_PCA[,i] - Temp_PCA[,j])^2)[,1], na.rm = TRUE)
}
}
levelplot(Gamma_estim)
dist( Sites[,2:3])
Dist <- dist( Sites[,2:3])
dim(Dist)
?dist
dim(Sites[,2:3])
Sites
Sites <- read.csv("Sites Germany.csv")
Dist <- dist(Sites[,2:3])
plot( Dist, Gamma_estim )
dim(Gamma_estim)
dim(Dist)
plot( as.vector(Dist), as.vector(Gamma_estim) )
length(as.vector(Dist))
length(as.vector(Gamma_estim))
lower.tri(Gamma_estim)
Sites <- read.csv("Sites Germany.csv")
Gamma_estim <- matrix(0,20,20)
Dist <- matrix(0,20,20)
for( i in 1:20 ){
for( j in 1:20 ){
Gamma_estim[i,j] <- mean(((Temp_PCA[,i] - Temp_PCA[,j])^2)[,1], na.rm = TRUE)
Dist[i,j] <- (Sites$Longitude[i] - Sites$Longitude[j])^2 + (Sites$Latitude[i] - Sites$Latitude[j])^2
}
}
plot( Dist, Sites )
dim(Dist)
plot( Dist, Gamma_estim )
Sites <- Sites %>%
mutate( PC1 = PCA$rotation[,1], PC2 = PCA$rotation[,2], PC3 = PCA$rotation[,3] ) %>%
pivot_longer( cols=PC1:PC3, names_to="PC" )
ggplot( Sites, aes( x=Longitude, y=Latitude) ) +
facet_wrap( ~PC ) +
annotation_map_tile() +
geom_spatial_point( aes(color=value), size=5 ) +
scale_color_distiller( palette="RdYlBu" ) +
labs( x="Longitude", y="Latitude", color="value" )
knitr::opts_chunk$set(echo = TRUE)
library( dplyr )
library( ggplot2 )
library( tidyr )
library( sf )
library( ggspatial )
library( prettymapr )
library( sp )
library( gstat )
RF <- read.csv("River Flow.csv")
RF <- RF %>% na.omit()
PCA <- prcomp( RF, scale. = TRUE )
Loc <- read.csv("Locations River Flow.csv")
Loc <- Loc %>%
mutate( PC1 = PCA$rotation[,1], PC2 = PCA$rotation[,2], PC3 = PCA$rotation[,3] ) %>%
pivot_longer( cols=PC1:PC3, names_to="PC" )
GB <- read_sf( "gadm41_GBR_shp (1)/gadm41_GBR_2.shp" )
GB <- GB %>% st_simplify( dTolerance = 500 )
ggplot( GB ) + geom_sf(fill="white") + theme_bw() +
geom_point(data=Loc, aes(x=Lon,y=Lat,color=value), size=5 ) +
scale_color_distiller( palette="Blues" ) +
xlim(-3.5,-1) + ylim(53,55.5) +
facet_wrap( ~PC ) +
labs( x="Longitude", y="Latitude", color="value" )
min(PCA$rotation[,1])
max(PCA$rotation[,1])
Meuse <- read.csv("Meuse.csv")
ggplot( Meuse, aes(x=Lon, y=Lat) ) + annotation_map_tile( zoom = 14 ) +
geom_spatial_point( aes(color=Zinc) ) +
scale_fill_distiller( palette="Reds", trans="reverse" ) +
labs( x="Longitude", y="Latitude", color="Log(Zinc concentration)")
Meuse_gamma <- Meuse
coordinates(Meuse_gamma) <- ~ Lon+Lat
gamma_hat <- variogram( Zinc~1, Meuse_gamma, cutoff=0.015  )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Soil <- read.csv( "SoilMoisture.csv" )
ggplot( Soil, aes(x = Longitude, y = Latitude, fill = Soil_Moisture) ) +
geom_tile() + scale_fill_viridis_c() + theme_bw() +
labs( x="Longitude", y="Latitude", fill="Soil Moisture" )
Soil <- na.omit( Soil )
coordinates( Soil ) <- ~Longitude+Latitude
gamma_hat <- variogram( Soil_Moisture~1, Soil, width=0.2, cutoff=7  )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Sites <- read.csv("Sites Germany.csv")
Temperature <- read.csv("Temperature Germany.csv")
Median_June <- Temperature %>%
filter( month(Date) == 6 ) %>%
group_by( Site ) %>%
summarise( Median = quantile(Temperature, 0.5, na.rm = TRUE) )
Soil <- read.csv( "SoilMoisture.csv" )
ggplot( Soil, aes(x = Longitude, y = Latitude, fill = Soil_Moisture) ) +
geom_tile() + scale_fill_viridis_c() + theme_bw() +
labs( x="Longitude", y="Latitude", fill="Soil Moisture" )
Soil <- na.omit( Soil )
coordinates( Soil ) <- ~Longitude+Latitude
gamma_hat <- variogram( Soil_Moisture~1, Soil, width=0.2, cutoff=7  )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Longitude < -4 )
Soil_East <- filter(Soil, Longitude >= -4 )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil, width=0.2, cutoff=7  )
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Longitude < -4 )
Soil_East <- filter(Soil, Longitude >= -4 )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.2, cutoff=7  )
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Longitude < -4 ) %>% na.omit( )
Soil_East <- filter(Soil, Longitude >= -4 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.2, cutoff=7  )
coordinates( Soil_Eest ) <- ~Longitude+Latitude
coordinates( Soil_West ) <- ~Longitude+Latitude
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Longitude < -4 ) %>% na.omit( )
Soil_East <- filter(Soil, Longitude >= -4 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.2, cutoff=7  )
coordinates( Soil_East ) <- ~Longitude+Latitude
gamma_East <- variogram( Soil_Moisture~1, Soil_East, width=0.2, cutoff=7  )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
geom_point( gamma_East, aes( x=dist, y=gamma/2 ), color = "red") +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "red", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
coordinates( Soil_West ) <- ~Longitude+Latitude
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Longitude < -4 ) %>% na.omit( )
Soil_East <- filter(Soil, Longitude >= -4 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.2, cutoff=4  )
coordinates( Soil_East ) <- ~Longitude+Latitude
gamma_East <- variogram( Soil_Moisture~1, Soil_East, width=0.2, cutoff=4  )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "red", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Latitude >40 ) %>% na.omit( )
Soil_East <- filter(Soil, Latitude <=40 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.2, cutoff=4  )
coordinates( Soil_East ) <- ~Longitude+Latitude
gamma_East <- variogram( Soil_Moisture~1, Soil_East, width=0.2, cutoff=4  )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "red", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Longitude < -4 ) %>% na.omit( )
Soil_East <- filter(Soil, Longitude >= -4 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.2, cutoff=4  )
coordinates( Soil_East ) <- ~Longitude+Latitude
gamma_East <- variogram( Soil_Moisture~1, Soil_East, width=0.2, cutoff=4  )
gamma_West$np
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Longitude < -4 ) %>% na.omit( )
Soil_East <- filter(Soil, Longitude >= -4 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.2, cutoff=4  )
coordinates( Soil_East ) <- ~Longitude+Latitude
gamma_East <- variogram( Soil_Moisture~1, Soil_East, width=0.2, cutoff=4  )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "red", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
coordinates( Soil_West ) <- ~Longitude+Latitude
Soil <- read.csv( "SoilMoisture.csv" )
Soil_West <- filter(Soil, Longitude < -4 ) %>% na.omit( )
Soil_East <- filter(Soil, Longitude >= -4 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Longitude+Latitude
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.1, cutoff=4  )
coordinates( Soil_East ) <- ~Longitude+Latitude
gamma_East <- variogram( Soil_Moisture~1, Soil_East, width=0.1, cutoff=4  )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "red", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "red", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" ) +
scale_color_manual( values = c("West" = "black", "East" = "red"),
name = "Region", breaks = c("West", "East"),  # Which values to display in the legend
labels = c("West", "East") )  # Custom labels for the legend
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) +
geom_point( size=2, color="West" ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "East", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" ) +
scale_color_manual( values = c("West" = "black", "East" = "red"),
name = "Region", breaks = c("West", "East"),  # Which values to display in the legend
labels = c("West", "East") )  # Custom labels for the legend
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) +
geom_point( size=2, color="West" ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "East", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) +
geom_point( size=2, color="West" )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) +
geom_point( size=2, color="West" ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2 ), color = "East", size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" ) +
scale_color_manual( values = c("black", "red"), name = "Region", breaks = c("West", "East") )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) +
geom_point( size=2, aes(color="West") ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2, color = "East"), size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" ) +
scale_color_manual( values = c("black", "red"), name = "Region", breaks = c("West", "East") )
gamma_West
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~Lon+Lat, data = Brazil, width=0.2, cutoff=4 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~1, data = Brazil, width=0.2, cutoff=4 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~Lon+Lat, data = Brazil )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~Lon+Lat, data = Brazil, width=0.2, cutoff=4 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~Lon+Lat, data = Brazil, width=0.1, cutoff=4 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
gamma_hat$np
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~Lon+Lat, data = Brazil, width=0.2, cutoff=4 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
gamma_hat$np
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~Lon+Lat, data = Brazil )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
gamma_hat$np
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~Lon+Lat, data = Brazil, width=0.5 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
knitr::opts_chunk$set(echo = TRUE)
library( dplyr )
library( lubridate )
library( ggplot2 )
library( tidyr )
library( sf )
library( ggspatial )
library( prettymapr )
library( sp )
library( gstat )
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp~1, data = Brazil, width=0.5 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Brazil <- read.csv( "Brazil Temperature.csv" )
coordinates( Brazil ) <- ~Lon+Lat
gamma_hat <- variogram( MeanTemp ~Lon+Lat, data = Brazil, width=0.5 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" )
Soil <- read.csv( "Brazil Temperature.csv" )
Soil <- read.csv( "Brazil Temperature.csv" )
Soil_West <- filter(Soil, Lat < -10 ) %>% na.omit( )
Soil_East <- filter(Soil, Lat >= -10 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Longitude+Latitude
coordinates( Soil_West ) <- ~Lon+Lat
gamma_West <- variogram( Soil_Moisture~1, Soil_West, width=0.1, cutoff=4  )
coordinates( Soil_West ) <- ~Lon+Lat
Soil <- read.csv( "Brazil Temperature.csv" )
Soil_West <- filter(Soil, Lat < -10 ) %>% na.omit( )
Soil_East <- filter(Soil, Lat >= -10 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Lon+Lat
gamma_West <- variogram( MeanTemp~1, Soil_West, width=0.1, cutoff=4  )
coordinates( Soil_East ) <- ~Lon+Lat
gamma_East <- variogram( MeanTemp~1, Soil_East, width=0.1, cutoff=4  )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) +
geom_point( size=2, aes(color="West") ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2, color = "East"), size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" ) +
scale_color_manual( values = c("black", "red"), name = "Region", breaks = c("West", "East") )
Soil <- read.csv( "Brazil Temperature.csv" )
Soil_West <- filter(Soil, Lat < -10 ) %>% na.omit( )
Soil_East <- filter(Soil, Lat >= -10 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Lon+Lat
gamma_West <- variogram( MeanTemp~1, Soil_West, width=0.5 )
coordinates( Soil_East ) <- ~Lon+Lat
gamma_East <- variogram( MeanTemp~1, Soil_East, width=0.5 )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) +
geom_point( size=2, aes(color="West") ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2, color = "East"), size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" ) +
scale_color_manual( values = c("black", "red"), name = "Region", breaks = c("West", "East") )
Soil <- read.csv( "Brazil Temperature.csv" )
Soil_West <- filter(Soil, Lat < -10 ) %>% na.omit( )
Soil_East <- filter(Soil, Lat >= -10 ) %>% na.omit( )
coordinates( Soil_West ) <- ~Lon+Lat
gamma_West <- variogram( MeanTemp~1, Soil_West, width=0.25 )
coordinates( Soil_East ) <- ~Lon+Lat
gamma_East <- variogram( MeanTemp~1, Soil_East, width=0.25 )
ggplot( gamma_West, aes( x=dist, y=gamma/2 ) ) +
geom_point( size=2, aes(color="West") ) +
geom_point( data=gamma_East, aes( x=dist, y=gamma/2, color = "East"), size=2 ) +
theme_bw() + labs( x="Distance", y="Semi-variogram" ) +
scale_color_manual( values = c("black", "red"), name = "Region", breaks = c("West", "East") )
knitr::opts_chunk$set(echo = TRUE)
library( dplyr )
library( ggplot2 )
library( tidyr )
library( sf )
library( ggspatial )
library( prettymapr )
library( spatstat )
Outbreaks <- read.csv("Outbreaks.csv")
SwineFever <- filter( Outbreaks, disease == "African swine fever" )
SwineFever %>%
count( country, sort=TRUE) %>%
slice_head( n=3 )
SwineFever_Baltic <- SwineFever %>%
filter( country %in% c( "Estonia", "Latvia", "Lithuania" ) )
ggplot( SwineFever_Baltic, aes( x=longitude,y=latitude ) ) +
annotation_map_tile( zoom=5 ) +
geom_spatial_point( )
ggplot( SwineFever_Baltic, aes( x=longitude,y=latitude ) ) +
annotation_map_tile( zoom=5 ) +
geom_spatial_point( )
ggplot( SwineFever_Baltic, aes( x=longitude,y=latitude ) ) +
annotation_map_tile( zoom=7 ) +
geom_spatial_point( )
ggplot( SwineFever_Baltic, aes( x=longitude,y=latitude ) ) +
annotation_map_tile( zoom=6 ) +
geom_spatial_point( )
SwineFever_Latvia  <- SwineFever %>% filter( country == "Latvia" )
SwineFever_Latvia  <- SwineFever %>% filter( country == "Latvia" )
Latvia <- read_sf( "Shapefile Latvia/gadm41_LVA_0.shp" )
Latvia <- read_sf( "Shapefiles/gadm41_LVA_0.shp" )
Latvia <- Latvia %>%
st_simplify( dTolerance = 1000 ) %>%
st_transform( crs=3857 )
SwineFever_transformed <- SwineFever_Latvia %>%
st_as_sf( coords=c("Lon","Lat"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
Latvia <- read_sf( "Shapefiles/gadm41_LVA_0.shp" )
Latvia <- Latvia %>%
st_simplify( dTolerance = 1000 ) %>%
st_transform( crs=3857 )
SwineFever_transformed <- SwineFever_Latvia %>%
st_as_sf( coords=c("longtidue","latitude"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
Latvia <- read_sf( "Shapefiles/gadm41_LVA_0.shp" )
Latvia <- Latvia %>%
st_simplify( dTolerance = 1000 ) %>%
st_transform( crs=3857 )
SwineFever_transformed <- SwineFever_Latvia %>%
st_as_sf( coords=c("longitude","latitude"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
Latvia_ppp <- ppp( SwineFever_transformed[,1],
SwineFever_transformed[,2],
window = as.owin(Latvia) )
par( mai=c(0.01,0.01,0.5,0.01) )
Latvia_Quadrants <- quadratcount( Latvia_ppp, nx=7, ny=5 )
plot( Latvia_Quadrants,
main="Quadrat counting for swine fever outbreaks across Latvia" )
par( mai=c(0.01,0.5,0.2,0.5) )
lambdaC <- density.ppp( Latvia_ppp, edge=TRUE )
plot( lambdaC, main="Swine fever outbreaks across Latvia" )
setwd("C:/Users/cr777/Desktop/Teaching 2024-2025/MA22019/MA22019 Lecture Notes/")
bookdown::render_book( "index.Rmd", "bookdown::gitbook" )
bookdown::render_book( "index.Rmd", "bookdown::pdf_book" )
Crimes     <- read.csv( "UtopiaCrimes.csv" )
Crimes %>%
count( Category, sort=TRUE ) %>%
slice_head( n=3 )
Burglaries <- Crimes %>%
filter( Category == "Burglary" ) %>%
count( District )
Population <- read.csv( "UtopiaPopulation.csv" )
Burglaries <- Burglaries %>%
inner_join( Population, by="District" ) %>%
mutate( Rate = 1000 * n / Population )
Utopia <- read_sf( "Shapefiles/UtopiaShapefile.shp" )
Utopia <- Utopia %>% inner_join( Burglaries, by=c("NAME_1"="District") )
ggplot( Utopia, aes(fill=Rate) ) + geom_sf() + theme_bw() +
labs( title="Rate of Burglaries per 1000 people",
x="Longitude", y="Latitude", fill="Rate" )
District44_Drugs <- filter( Crimes, Category == "Drug Possession",
District == "District 44" )
District44 <- filter( Utopia, NAME_1 == "District 44" )
District44 <- st_reverse( District44 )
District44_ppp <- ppp( District44_Drugs$Longitude, District44_Drugs$Latitude,
poly = District44$geometry[[1]][[1]] )
Drugs_transformed <- District44_Drugs %>%
st_as_sf( coords=c("longitude","latitude"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
Drugs_transformed <- District44_Drugs %>%
st_as_sf( coords=c("Longitude","Latitude"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
District44_ppp <- ppp( Drugs_transformed[,1],
Drugs_transformed[,2],
window = as.owin(District44) )
Drugs_transformed <- District44_Drugs %>%
st_as_sf( coords=c("Longitude","Latitude"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
District44 <- District44 %>% st_transform( crs=3857 )
District44_ppp <- ppp( Drugs_transformed[,1],
Drugs_transformed[,2],
window = as.owin(District44) )
plot( density.ppp(District44_ppp, edge = TRUE),
main="Drug Possession across District 44" )
District44_Drugs <- filter( Crimes, Category == "Drug Possession",
District == "District 44", Year==2021  )
District44 <- filter( Utopia, NAME_1 == "District 44" )
District44 <- st_reverse( District44 )
District44_ppp <- ppp( District44_Drugs$Longitude, District44_Drugs$Latitude,
poly = District44$geometry[[1]][[1]] )
Drugs_transformed <- District44_Drugs %>%
st_as_sf( coords=c("Longitude","Latitude"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
District44 <- District44 %>% st_transform( crs=3857 )
District44_ppp <- ppp( Drugs_transformed[,1],
Drugs_transformed[,2],
window = as.owin(District44) )
plot( density.ppp(District44_ppp, edge = TRUE),
main="Drug Possession across District 44" )
District44_Drugs <- filter( Crimes, Category == "Drug Possession",
District == "District 44", Year>=2020  )
District44 <- filter( Utopia, NAME_1 == "District 44" )
District44 <- st_reverse( District44 )
District44_ppp <- ppp( District44_Drugs$Longitude, District44_Drugs$Latitude,
poly = District44$geometry[[1]][[1]] )
Drugs_transformed <- District44_Drugs %>%
st_as_sf( coords=c("Longitude","Latitude"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
District44 <- District44 %>% st_transform( crs=3857 )
District44_ppp <- ppp( Drugs_transformed[,1],
Drugs_transformed[,2],
window = as.owin(District44) )
plot( density.ppp(District44_ppp, edge = TRUE),
main="Drug Possession across District 44" )
District44_Drugs <- filter( Crimes, Category == "Drug Possession",
District == "District 44", Year>=2020  )
District44 <- filter( Utopia, NAME_1 == "District 44" )
District44 <- st_reverse( District44 )
District44_ppp <- ppp( District44_Drugs$Longitude, District44_Drugs$Latitude,
poly = District44$geometry[[1]][[1]] )
UK <- read_sf( "UK Shapefile/UK.shp" )
UK_county <- read_sf( "UK Shapefile/UK_admin.shp" )
Squirrels <- read.csv( "GreySquirrels.csv" )
