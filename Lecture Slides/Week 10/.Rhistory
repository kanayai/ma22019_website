knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidytext)
library(tidyr)
library(topicmodels)
NYT <- read.csv( "NYT.csv" )
NYT <- NYT %>% mutate( ID=1:nrow(NYT) )
NYT_count <- NYT %>%
unnest_tokens( word, lead_paragraph ) %>%
anti_join( stop_words, by="word" ) %>%
count( ID, word, sort = TRUE )
NYT_dtm <- NYT_count %>% cast_dtm( ID, word, n )
NYT_LDA <- LDA( NYT_dtm, k = 2, method="Gibbs", control = list(seed=2024) )
tidy( NYT_LDA , matrix = "gamma" ) %>%
filter( topic==1 ) %>%
ggplot( aes( y=gamma ) ) + theme_bw() +
geom_boxplot() + labs( y="Proportion" )
tidy( NYT_LDA , matrix = "beta" ) %>%
mutate( topic = case_when( topic==1 ~ "Topic1", topic==2 ~ "Topic2") ) %>%
pivot_wider( names_from = topic, values_from = beta, values_fill = 0 ) %>%
ggplot( aes(x=Topic1, y=Topic2) ) +  coord_trans( x="sqrt", y="sqrt" ) +
geom_point() + theme_bw() +
geom_text( aes(label=term), check_overlap = TRUE, vjust=1 ) +
labs( x="Term Frequency in Topic 1", y="Term Frequency in Topic 2" )
knitr::opts_chunk$set(echo = TRUE)
Manchester <- read.csv( "Manchester.csv" )
library( dplyr )
library( ggplot2 )
library( prettymapr )
library( ggspatial )
library( sp )
library( gstat )
ggplot( Manchester, aes( x=Lon, y=Lat ) ) +
annotation_map_tile( zoom=11 ) +
geom_spatial_point( aes(color=Level), size=4 ) +
scale_color_distiller( palette="Reds", trans="reverse" ) +
labs( x="Longitude", y="Latitude", color="PM10 Levels" )
coordinates( Manchester ) <- ~Lon+Lat
gamma_hat <- variogram( Level~1, Manchester, cutoff=0.1 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
labs( x="Distance", y="Semi-variogram" )
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidytext)
library(tidyr)
library(topicmodels)
NYT <- read.csv( "NYT.csv" )
NYT <- NYT %>% mutate( ID=1:nrow(NYT) )
NYT_count <- NYT %>%
unnest_tokens( word, lead_paragraph ) %>%
anti_join( stop_words, by="word" ) %>%
count( ID, word, sort = TRUE )
NYT_dtm <- NYT_count %>% cast_dtm( ID, word, n )
tidy( NYT_LDA , matrix = "gamma" ) %>%
filter( topic==1 ) %>%
ggplot( aes( y=gamma ) ) + theme_bw() +
geom_boxplot() + labs( y="Proportion" )
NYT_LDA <- LDA( NYT_dtm, k = 2, method="Gibbs", control = list(seed=2024) )
tidy( NYT_LDA , matrix = "gamma" ) %>%
filter( topic==1 ) %>%
ggplot( aes( y=gamma ) ) + theme_bw() +
geom_boxplot() + labs( y="Proportion" )
tidy( NYT_LDA , matrix = "beta" ) %>%
mutate( topic = case_when( topic==1 ~ "Topic1", topic==2 ~ "Topic2") ) %>%
pivot_wider( names_from = topic, values_from = beta, values_fill = 0 ) %>%
ggplot( aes(x=Topic1, y=Topic2) ) +  coord_trans( x="sqrt", y="sqrt" ) +
geom_point() + theme_bw() +
geom_text( aes(label=term), check_overlap = TRUE, vjust=1 ) +
labs( x="Term Frequency in Topic 1", y="Term Frequency in Topic 2" )
