knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidytext)
library(wordcloud)
library(stringr)
JaneEyre_raw <- readLines( "JaneEyre.txt" )
JaneEyre_raw <- data.frame( text = JaneEyre_raw )
JaneEyre <- JaneEyre_raw %>% unnest_tokens( word, text )
nrow(JaneEyre)
slice_head( JaneEyre, n=10 )
JaneEyre <- JaneEyre %>% mutate( word = gsub( "\\_", "", word ) )
JaneEyre_Count <- JaneEyre %>% count( word, sort=TRUE )
slice_head(JaneEyre_Count, n=10 )
JaneEyre_Count <- JaneEyre_Count %>%
mutate( 'term frequency'=n/sum(n), rank=row_number() ) %>%
rename( Count = n )
slice_head(JaneEyre_Count, n=10)
ggplot( JaneEyre_Count, aes( x=rank, y=`term frequency` ) ) +
geom_line( linewidth=1.5 ) +
coord_trans( x="log10", y="log10" )
data("stop_words")
JaneEyre_Count <- JaneEyre_Count %>%
anti_join(stop_words, by="word")
slice_head(JaneEyre_Count, n=10)
JaneEyre_Count %>%
slice_max( Count, n=10 ) %>%
mutate( word = reorder(word,Count) ) %>%
ggplot( aes( x=Count, y=word ) ) +
geom_col() + labs( x="Count", y="" )
JaneEyre_Count %>%
slice_max( Count, n=10 ) %>%
ggplot( aes( x=Count, y=word ) ) +
geom_col() + labs( x="Count", y="" )
JaneEyre_Count %>%
slice_max( Count, n=10 ) %>%
mutate( word = reorder(word,Count) ) %>%
ggplot( aes( x=Count, y=word ) ) +
geom_col() + labs( x="Count", y="" )
JaneEyre_Count %>%
with( wordcloud( word, Count, max.words=40, colors=topo.colors(n=40) ) )
JaneEyre <- JaneEyre_raw %>%
mutate( line = row_number() ) %>%
unnest_tokens( word, text ) %>%
mutate( word = gsub( "_", "", word ) )
AFINN <- get_sentiments( "afinn" )
JaneEyre_AFINN <- inner_join( JaneEyre, AFINN, by="word" )
slice_head(AFINN, n=5)
JaneEyre_AFINN <- inner_join( JaneEyre, AFINN, by="word" )
slice_head(JaneEyre_AFINN, n=5)
JaneEyre_AFINN %>%
filter( word != "miss" ) %>%
mutate( sentiment = cumsum( value ) ) %>%
ggplot( aes( x=line, y=sentiment ) ) +
geom_line( linewidth=1.2 ) +
labs( x="Line number", y="Sentiment" )
JaneEyre_chapters <- JaneEyre_raw %>%
mutate( chapter = cumsum( str_detect(
text, regex("^chapter ", ignore_case = TRUE)
) ) )
JaneEyre_chapters <- JaneEyre_chapters %>%
filter( chapter > 0 ) %>%
unnest_tokens( word, text ) %>%
mutate( word = gsub( "_", "", word ) )
slice_head(JaneEyre_chapters)
slice_head(JaneEyre_chapters, n=5)
JaneEyre_chapters %>%
inner_join( AFINN, by="word" ) %>%
group_by( chapter ) %>%
summarise( sentiment = mean(value) ) %>%
ggplot( aes( x=chapter, y=sentiment ) ) +
geom_col() + labs( x="Chapter", y="AFINN sentiment score" )
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidytext)
library(dplyr)
library(ggplot2)
library(tidytext)
JaneEyre_raw <- readLines( "JaneEyre.txt", encoding = "UTF-8" )
JaneEyre_raw <- data.frame( text = JaneEyre_raw )
JaneEyre <- JaneEyre_raw %>%
unnest_tokens(word, text) %>%
mutate( word = gsub( "_", "", word ) ) %>%
count( word, sort=TRUE ) %>%
mutate( 'term frequency' = n / sum(n) ) %>%
anti_join( stop_words )
WutheringHeights_raw <- readLines( "WutheringHeights.txt", encoding = "UTF-8" )
WutheringHeights_raw <- data.frame( text = WutheringHeights_raw )
WutheringHeights <- WutheringHeights_raw %>%
unnest_tokens(word, text) %>%
mutate( word = gsub( "_", "", word ) ) %>%
count( word, sort=TRUE ) %>%
mutate( 'term frequency' = n / sum(n) ) %>%
anti_join( stop_words )
tf <- full_join( JaneEyre, WutheringHeights, by="word" ) %>%
rename( JaneEyre='term frequency.x', Heights='term frequency.y' )
glimpse(tf)
tf <- tf %>%
mutate( JaneEyre = case_when( is.na(JaneEyre) == TRUE ~ 0, .default = JaneEyre),
Heights = case_when( is.na(Heights) == TRUE ~ 0, .default = Heights) )
ggplot( tf, aes( x=JaneEyre, y=Heights ) ) +
geom_point() +
geom_text( aes(label=word), check_overlap = TRUE, vjust=1.5 ) +
coord_trans( x="sqrt", y="sqrt" ) + theme_bw() +
labs( x="Term Frequency in Jane Eyre",
y="Term Frequency in Wuthering Heights" )
AFINN <- get_sentiments( "afinn" )
dim(AFINN)
AFINN <- get_sentiments( "bing" )
dim(AFINN)
