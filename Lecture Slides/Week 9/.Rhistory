knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(patchwork)
library(sf)
library(ggspatial)
library(prettymapr)
library(spatstat)
Tornadoes <- read.csv( "Tornadoes.csv" )
USA <- read_sf( "Shapefile USA/gadm41_USA_1.shp" )
KS <- filter( USA, NAME_1=="Kansas" ) %>%
st_simplify( dTolerance = 2000 )
TX <- filter( USA, NAME_1=="Texas" ) %>%
st_simplify( dTolerance = 2000 )
KS <- KS %>% st_transform( crs=3857 )
TX <- TX %>% st_transform( crs=3857 )
Tornadoes_transformed <- Tornadoes %>%
st_as_sf( coords=c("Lon","Lat"), crs=4326 ) %>%
st_transform( crs=3857 ) %>%
st_coordinates( )
Texas_ppp <- ppp( Tornadoes_transformed[,1], Tornadoes_transformed[,2],
window = as.owin(TX) )
Kansas_ppp <- ppp( Tornadoes_transformed[,1], Tornadoes_transformed[,2],
window = as.owin(KS) )
par( mai=c(0.01,0.5,0.2,0.5), mfrow=c(1,2) )
lambdaC_KS <- density.ppp( Kansas_ppp, edge=TRUE )
plot( lambdaC_KS, main="Kansas" )
lambdaC_TX <- density.ppp( Texas_ppp, edge=TRUE )
plot( lambdaC_TX, main="Texas" )
par( mai=c(0.01,0.5,0.2,0.5), mfrow=c(1,2) )
lambdaC_KS <- density.ppp( Kansas_ppp, edge=TRUE )
plot( lambdaC_KS, main="Kansas" )
lambdaC_TX <- density.ppp( Texas_ppp, edge=TRUE )
plot( lambdaC_TX, main="Texas", add = TRUE )
min(lambdaC_KS$xrange)
min(lambdaC_TX$xrange)
?plot.quadratcount
max(lambdaC_KS$xrange)
par( mai=c(0.01,0.5,0.2,0.5), mfrow=c(1,2) )
lambdaC_KS <- density.ppp( Kansas_ppp, edge=TRUE )
plot( lambdaC_KS, main="Kansas", xlim=c(-11871754,-10530016 ) )
lambdaC_TX <- density.ppp( Texas_ppp, edge=TRUE )
plot( lambdaC_TX, main="Texas", add = TRUE )
max(lambdaC_KS$yrange)
min(lambdaC_TX$yrange)
par( mai=c(0.01,0.5,0.2,0.5), mfrow=c(1,2) )
lambdaC_KS <- density.ppp( Kansas_ppp, edge=TRUE )
plot( lambdaC_KS, main="Kansas",
xlim=c(-11871754,-10530016 ),
ylim=c(2979553,4866510) )
lambdaC_TX <- density.ppp( Texas_ppp, edge=TRUE )
plot( lambdaC_TX, main="Texas", add = TRUE )
?density.ppp
lambdaC_TX
class(lambdaC_TX)
spatstat::imappend(list(lambdaC_TX,lambdaC_KS))
lambdaC_TX + lambdaC_KS
plot(lambdaC_TX + lambdaC_KS)
?superimpose
temp <- superimpose(lambdaC_TX, lambdaC_KS)
