---
title: "MA22019 2025 - Revision Class"
author: "Additional example on the semi-variogran"
format: html
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Loading packages

```{r, message=FALSE, warning=FALSE}
library( dplyr )
library( ggplot2 )
library( prettymapr )
library( ggspatial )
library( sp )
library( gstat )
```

### Loading the data

The file "Manchester.csv" contains some synthetic air pollution data for a day in Manchester:

```{r}
Manchester <- read.csv("data/manchester.csv" )
```

### Data visualization

We start by visualizing the data:

```{r, fig.align='center', out.width='60%', warning=FALSE, message=FALSE, fig.width=6, fig.height=8}
ggplot( Manchester, aes( x=Lon, y=Lat ) ) + 
  annotation_map_tile( zoom=11 ) + 
  geom_spatial_point( aes(color=Level), size=4 ) +
  scale_color_distiller( palette="Reds", trans="reverse" ) +
  labs( x="Longitude", y="Latitude", color="PM10 Levels" )
```

### Analysis of the spatial dependence

We estimate the semi-variogram using

```{r, fig.align='center', out.width='50%', fig.width=5, fig.height=3}
coordinates( Manchester ) <- ~Lon+Lat
gamma_hat <- variogram( Level~1, Manchester, cutoff=0.1 )
ggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +
  labs( x="Distance", y="Semi-variogram" )
```

a) What do we conclude?

b) Is it reasonable to assume that (i) the mean is constant and (ii) dependence is fully specified by spatial distance?

