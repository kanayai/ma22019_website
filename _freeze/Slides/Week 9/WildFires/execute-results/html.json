{
  "hash": "3c9bc2ccaf616c0e446f893d851fc6ef",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis of Wildfires\"\nauthor: \"Christian Rohrbeck\"\ndate: \"02/04/2025\"\nformat: html\n---\n\n\n\n## Loading the packages and the Californian wildfire data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(sf)\nlibrary(ggspatial)\nlibrary(prettymapr)\nlibrary(spatstat)\n\nWildFires <- read.csv( \"Wildfires.csv\" )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(WildFires)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 1,465\nColumns: 3\n$ AcresBurned <int> 257314, 30274, 27531, 27440, 22992, 20292, 14754, 12503, 1…\n$ Latitude    <dbl> 37.85700, 34.58559, 33.70950, 39.12000, 37.27900, 33.86157…\n$ Longitude   <dbl> -120.0860, -118.4232, -116.7288, -120.6500, -119.3180, -11…\n```\n\n\n:::\n:::\n\n\n\n## Extracting the shapefile for California\n\nA shapefile is imported in the form of a data frame and thus we can apply data wrangling techniques to it:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUSA <- read_sf( \"Shapefile USA/gadm41_USA_1.shp\" )\nCalifornia <- filter( USA, NAME_1==\"California\" ) %>% \n  st_simplify(dTolerance = 2000)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(California) + geom_sf()\n```\n\n::: {.cell-output-display}\n![](WildFires_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n## Visualize the data\n\nWe can use either of the two techniques we introduced for visualizing point-referenced data.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nshape <- ggplot( data=California ) + theme_bw() + geom_sf() + \n  geom_point( data=WildFires, aes(x=Longitude,y=Latitude, color=log(AcresBurned) ) ) +\n  scale_color_distiller( palette=\"Reds\", trans=\"reverse\" ) +\n  theme( legend.position=\"none\" )\nmap <- ggplot( WildFires, aes( Longitude, y=Latitude ) ) + \n  annotation_map_tile() + geom_spatial_point( aes(color=log(AcresBurned)) ) + \n  scale_color_distiller( palette=\"Reds\", trans=\"reverse\" ) +\n  labs( x=\"Longitude\", y=\"Latitude\", color=\"Log( Acres burned)\" )\nshape + map \n```\n\n::: {.cell-output-display}\n![](WildFires_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=85%}\n:::\n:::\n\n\n\n## Quadrat counting estimate\n\nWe need to generate a **ppp** object and one option to do this is:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nWildFires_ppp <- ppp( WildFires$Longitude, WildFires$Latitude,\n                      poly = California$geometry[[1]][[1]] )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: 7 points were rejected as lying outside the specified window\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: data contain duplicated points\n```\n\n\n:::\n:::\n\n\nWe now use the **quadratcount()** function :\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npar( mfrow=c(1,2), mai=c(0.01,0.01,0.5,0.01) )\nWildFireQuadrants <- quadratcount( WildFires_ppp, nx=2, ny=2 )\nplot( WildFireQuadrants )\nWildFireQuadrants <- quadratcount( WildFires_ppp, nx=6, ny=6 )\nplot( WildFireQuadrants )\n```\n\n::: {.cell-output-display}\n![](WildFires_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\n\n## Kernel smoothed intensity function\n\nLet's compare the estimate with and without edge correction:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npar( mfrow=c(1,2), mai=c(0.01,0.5,0.2,0.5) )\nlambdaK <- density.ppp( WildFires_ppp, edge=FALSE )\nplot( lambdaK, main=\"Uncorrected\" )\nlambdaC <- density.ppp( WildFires_ppp, edge=TRUE )\nplot( lambdaC, main=\"Corrected\" )\n```\n\n::: {.cell-output-display}\n![Uncorrected (left) and corrected (right) kernel smoothed intensity for Californian wildfires.](WildFires_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Selection of the bandwidth\n\nIn some cases we may to choose the parameter $\\sigma$. Here are two poor choices which illustrate the effect of the parameter:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npar( mai=c(0.01,0.5,0.2,0.5), mfrow=c(1,2) )\nlambda_sigma0.1 <- density.ppp( WildFires_ppp, edge=TRUE, sigma = 0.1 )\nplot( lambda_sigma0.1, main=\"sigma=0.1\" )\nlambda_sigma10 <- density.ppp( WildFires_ppp, edge=TRUE, sigma = 10 )\nplot( lambda_sigma10, main=\"sigma=10\" )\n```\n\n::: {.cell-output-display}\n![Corrected kernel smoothed intensity estimates for Californian wildfires with sigma=0.1 (left) and sigma=10 (right).](WildFires_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=100%}\n:::\n:::\n\n",
    "supporting": [
      "WildFires_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}