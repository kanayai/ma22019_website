{
  "hash": "6d51d4b58784c36c9aac4fa6b78740ac",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Coursework 1 Data Generation\"\nauthor: \"Dr. Karim Anaya-Izquierdo\"\ndate: \"December 2024\"\nformat: html\n---\n\n\n\n## Air pollution levels - PM10\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSites <- rep(NA, 6)\nfor( i in 1:6 )\n  Sites[i] <- paste(\"Site\", i, sep=\"\" )\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nalpha_PM10 <- c( rnorm( 2, 20, 5), rnorm( 4, 50, 10) )\nbeta_PM10 <- c( runif(2,0,5), runif(2,0,10), runif(2,0,20) ) \n\nPM10 <- matrix( 0, 3652, 6 )\n\nlibrary(mvtnorm)\nSigma_trend <- matrix(0.045,10,10)\ndiag(Sigma_trend) <- 0.05\ntrend <- rmvnorm(3652, mean = rep(-0.01,10), sigma = Sigma_trend )\ntrend <- apply( trend, 2, cumsum )\nfor( i in 1:6 )\n  trend[,i] <- 0.8 + 0.2 * ( trend[,i] - min( trend[,i] ) ) / \n  ( max(trend[,i]) - min( trend[,i] ) )\n\nSigma_noise <- matrix(0.3,10,10)\ndiag(Sigma_noise) <- 1\nnoise <- rmvnorm(3652, mean = rep(0,10), sigma = Sigma_noise )\n\nfor( i in 1:6 ){\n  PM10[,i] <- ( alpha_PM10[i] + beta_PM10[i] * cos( 2 * pi * (1:3652) / 365 ) ) * \n    trend[,i] + beta_PM10[i] * noise[,i]\n}\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed( 2020 )\nfor( i in c(3,5) ){\n  temp <- sample( x=1:3652, size=sample(size = 1,x=3:10) )\n  m <- length( temp )\n  for( j in 1:m ){\n    z <- rpois( 1, runif(1,5,15) ) \n    temp <- c( temp, temp[j]+(1:z) )\n  }\n  PM10[temp,i] <- NA\n}\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPM10 <- PM10[,sample(1:6,6)]\nPM10 <- as.data.frame( round(PM10,1) )\nnames(PM10) <- Sites\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(lubridate)\nDate0 <- as_date(\"2014-12-31\")\nPM10 <- PM10 %>% \n  mutate( Date = Date0 + (1:3652) ) %>%\n  relocate( Date, .before=\"Site1\" )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(PM10, \"PM10.csv\", row.names = FALSE)\n```\n:::\n\n\n\n# Energy Consumption\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia <- read.csv(\"AEP_hourly.csv\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia <- Utopia %>% mutate( Date = ymd_hms(Datetime) )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia <- Utopia %>% mutate( Date = Date %m+% years(6) %m+% minutes(30) )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia <- Utopia %>% filter( year(Date) < 2024, year(Date)>2010 )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia <- Utopia %>% mutate( Date = Date %m+% years(1) )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia <- Utopia %>% \n  relocate( Date, .before = Datetime ) %>%\n  select( -Datetime ) %>%\n  rename( Demand = AEP_MW )\nwrite.csv(Utopia, \"Utopia Energy Consumption.csv\", row.names = FALSE)\n```\n:::\n\n\n## Simulate energy production\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia <- Utopia %>% mutate( Day = date(Date) )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia_daily <- Utopia %>%\n  group_by( Day ) %>%\n  summarise( Demand =sum(Demand) )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia_daily <- Utopia_daily %>%\n  mutate( Solar=Demand, Wind=Demand, Coal=Demand )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia_daily$Solar <- 500000 * ( 0.06 + 0.05 * \n  sin( pi * yday(Utopia_daily$Day)/365 ) + \n    (year(Utopia_daily$Day) > 2017) * (year(Utopia_daily$Day) - 2017) * 0.012 )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nUtopia_daily$Solar <- Utopia_daily$Solar * exp(rnorm(4745,0,0.3) )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nUtopia_daily$Wind <- 424300 * ( 0.06 + \n    (year(Utopia_daily$Day) > 2015) * (year(Utopia_daily$Day) - 2015) * 0.015 ) * exp(rnorm(4745,-0.1,0.3) )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot( (Utopia_daily$Wind+Utopia_daily$Solar) / Utopia_daily$Demand)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nUtopia_daily$Coal <- Utopia_daily$Demand - Utopia_daily$Solar - Utopia_daily$Wind\nUtopia_daily$Coal <- 0.975 * (Utopia_daily$Coal) * (Utopia_daily$Coal>0) \n\nUtopia_daily$Coal <- Utopia_daily$Coal * exp( rnorm( length(Utopia_daily$Coal),0.1,0.05) )\nUtopia_daily$Nuclear <- Utopia_daily$Demand - Utopia_daily$Solar - Utopia_daily$Wind - Utopia_daily$Coal\n\nUtopia_daily$Nuclear <- rnorm(length(Utopia_daily$Coal), 10000, 10) + Utopia_daily$Nuclear * (Utopia_daily$Nuclear>0)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot( (Utopia_daily$Solar+Utopia_daily$Wind+Utopia_daily$Coal+Utopia_daily$Nuclear) / Utopia_daily$Demand)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUtopia_daily <- Utopia_daily %>% select(-Demand)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(Utopia_daily, \"Utopia Energy Production.csv\", row.names = FALSE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHouses <- read.csv( \"Housing Register.csv\" )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- nrow( Houses )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nind <- sample( 1:n, size=50000 )\nHouses <- Houses[ind,]\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHouses <- Houses %>% select( Year, Type )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexpit <- function(x) return( exp(x) / (1+exp(x)) )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nHouses <- Houses %>% mutate( ERC2014 = \"A\" )\nTypes <- unique( Houses$Type )\n\nfor( j in Types ){\n\n  ind <- which( Houses$Type == j )\n  Houses_j <- Houses[ind,]\n  n_j <- nrow( Houses_j )\n\n  a <- 10\n  b <- 1 + rbeta( 1, 20,80 )\n  c <- runif(1,0.9,1.5)\n  \n  prob_A <- a - b * (Houses_j$Year - 1900) / 14\n  prob_A <- expit( prob_A )\n  prob_B <- c - b * (Houses_j$Year - 1900) / 40\n  prob_B <- expit( prob_B )\n  \n  prob     <- matrix(0,n_j,3)\n  prob[,1] <- 1- prob_A\n  prob[,2] <- prob_A - prob_B\n  prob[,3] <- prob_B\n  \n  for( i in 1:n_j )\n    Houses$ERC2014[ind[i]] <- sample( x=c(\"A\",\"B\",\"C\"), size=1, \n                                      prob = prob[i,] )\n}\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHouses <- Houses %>% \n  mutate( ERC2018 = ERC2014 ) %>%\n  mutate( ERC2018 = case_when( Year>2018 ~ NA, .default = ERC2018 ),\n          ERC2014 = case_when( Year>2014 ~ NA, .default = ERC2014,) ) %>%\n  filter( is.na(ERC2018) == FALSE )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2025)\nind <- which( Houses$ERC2014 == \"B\" )\nj <- rbinom( length(ind), 1, 0.0312 )\nHouses$ERC2018[ind[j]] <- \"A\"\nind <- which( Houses$ERC2014 == \"C\" )\nj <- rbinom( length(ind), 1, 0.0632 )\nHouses$ERC2018[ind[j]] <- \"B\"\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv( Houses, \"Utopia Energy Efficiency.csv\", row.names = FALSE )\n```\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}