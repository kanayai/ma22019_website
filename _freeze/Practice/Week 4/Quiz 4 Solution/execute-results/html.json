{
  "hash": "66b5e8413b6799fdc65c7e5e99ad4641",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"MA22019 2025 - Solutions for Quiz 4\"\nsubtitle: \"Mise en place\"\ncategories: [\"Quiz\", \"Solutions\"]\n---\n\n\n\n### **Overview**\n\nExercises 1-3 help you with revising the techniques covered in Week 3. There are no tutorial and homework questions as Coursework 1 will be released at 15:00 on Friday, 21 February 2025. \n\nBefore starting the questions, make sure to load the different packages we considered so far: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(tidyr)\n```\n:::\n\n\n### **Exercise 1 - CO$_2$ emissions across the globe**\n\nThe file \"CO2 Emissions.csv\" provides the recorded daily CO$_2$ emissions across six different sectors between 1 January 2019 and 31 May 2023 for 11 countries, the EU, the rest of the world (ROW) and across and the planet (WORLD). Enter your answers to the questions below via the quiz on Moodle.\n\na) Which two countries recorded the highest total CO$_2$ emissions across all sectors for the considered time window?  \n\n<p style=\"color:blue\"> *We start by loading the data:*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 <- read.csv( \"data/CO2 Emissions.csv\", header=TRUE )\n```\n:::\n\n\n<p style=\"color:blue\"> *We sum up all the observed values separately for each country using functions from the dplyr package: *</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2 %>%\n  group_by( country ) %>%\n  summarize( Total=sum( emissions) ) %>%\n  arrange( desc(Total) ) %>%\n  slice_head( n=5 )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 2\n  country     Total\n  <chr>       <dbl>\n1 WORLD     155540.\n2 China      48003.\n3 ROW        46393.\n4 US         21632.\n5 EU27 & UK  14004.\n```\n\n\n:::\n:::\n\n\n<p style=\"color:blue\"> *We find that China and the United States had the most emissions between 1 January 2019 and 31 May 2023 (is this a surprise?). *</p>\n\nb) Create a pie chart that illustrates the total emissions per sector for the UK between 1 January 2019 and 31 May 2023. Which sector of the UK economy produced the most CO$_2$ emissions over the observation period?\n\n<p style=\"color:blue\">*We first extract the observations for the UK and then calculate the total number of emissions for each sector*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCO2_UK <- CO2 %>%\n  filter( country==\"UK\" ) %>%\n  group_by( sector ) %>%\n  summarize( Total=sum(emissions) )\nCO2_UK\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  sector                  Total\n  <chr>                   <dbl>\n1 Domestic Aviation        7.29\n2 Ground Transport       502.  \n3 Industry               280.  \n4 International Aviation 109.  \n5 Power                  308.  \n6 Residential            400.  \n```\n\n\n:::\n:::\n\n\n<p style=\"color:blue\">*We can now adapt the code from the lecture notes for creating the pie chart:*</p>\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot( CO2_UK, aes( x=\"\", y=Total, fill=sector ) ) +\n  geom_col() + coord_polar( theta=\"y\" ) + \n  labs( x=\"\", y=\"Emissions\" )\n```\n\n::: {.cell-output-display}\n![](Quiz-4-Solution_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n<p style=\"color:blue\">*The pie chart shows that the sector with the most emissions was ground transport which accounted for about 30% of the recorded CO$_2$ emissions.*</p>\n\n\n### **Exercise 2 - Traffic between Minneapolis and St Paul**\n\nThe file \"Traffic Minnesota.csv\" contains hourly data on the traffic volume for westbound I-94, a major interstate highway in the US that connects Minneapolis and Saint Paul, Minnesota. The data was collected by the Minnesota Department of Transportation (MnDOT) from 2012 to 2018 at a station roughly midway between the two cities.\n\nThe variables are\n\n* **traffic_volume:** Hourly I-94 reported westbound traffic volume.\n\n* **holiday:** Indicates whether the date is a US national holiday or a regional holiday (such as the Minnesota State Fair).\n\n* **date_time:** Shows the hour of the data collected in local CST time.\n\n\na) Use the function **dmy_hm()** in the lubridate R package to convert the variable **date_time** to its correct type. Apply the function **weekdays()** to extract the day of the week and store this information as a separate variable within the data frame.\n\n<p style=\"color:blue\">*We start by loading the data.*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTraffic <- read.csv( \"data/Traffic Minnesota.csv\" )\n```\n:::\n\n\n<p style=\"color:blue\">*We then use the functions* **dmy_hm()** *(from the lubridate package)* *and* **weekdays()** *as required*:</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTraffic <- Traffic %>% mutate( date_time = dmy_hm(date_time) )\nTraffic <- Traffic %>% mutate( Weekday = weekdays(date_time) )\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTraffic <- Traffic %>% distinct(date_time, .keep_all = TRUE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTraffic <- Traffic %>%\n  group_by( Date = date(date_time) ) %>%\n  mutate( holiday = holiday[1] )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfilter( Traffic, holiday != \"None\" )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,203 × 8\n# Groups:   Date [53]\n   traffic_volume holiday       temp rain_1h snow_1h date_time           Weekday\n            <int> <chr>        <dbl>   <dbl>   <dbl> <dttm>              <chr>  \n 1            455 Columbus Day  273.       0       0 2012-10-08 00:00:00 Monday \n 2            336 Columbus Day  273.       0       0 2012-10-08 01:00:00 Monday \n 3            265 Columbus Day  272.       0       0 2012-10-08 02:00:00 Monday \n 4            314 Columbus Day  271.       0       0 2012-10-08 03:00:00 Monday \n 5            779 Columbus Day  271.       0       0 2012-10-08 04:00:00 Monday \n 6           2571 Columbus Day  270.       0       0 2012-10-08 05:00:00 Monday \n 7           5563 Columbus Day  270.       0       0 2012-10-08 06:00:00 Monday \n 8           6676 Columbus Day  270.       0       0 2012-10-08 07:00:00 Monday \n 9           5966 Columbus Day  271.       0       0 2012-10-08 08:00:00 Monday \n10           4832 Columbus Day  274.       0       0 2012-10-08 09:00:00 Monday \n# ℹ 1,193 more rows\n# ℹ 1 more variable: Date <date>\n```\n\n\n:::\n:::\n\n\nb) Answer the following two questions using the data and submit your solutions via the Moodle quiz on Moodle:\n\n    (i) What is the average traffic volume on a Saturday?\n    \n<p style=\"color:blue\">*We can use functions from the dplyr R package here:.*</p>\n    \n\n::: {.cell}\n\n```{.r .cell-code}\nTraffic %>% \n  filter( Weekday==\"Saturday\" ) %>%\n  summarize( Average = mean(traffic_volume) )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 266 × 2\n   Date       Average\n   <date>       <dbl>\n 1 2012-10-06   3257.\n 2 2012-10-13   2938.\n 3 2012-10-20   2891.\n 4 2012-10-27   3065.\n 5 2012-11-03   2810.\n 6 2012-11-10   2808.\n 7 2012-11-17   2779.\n 8 2012-11-24   2525.\n 9 2012-12-01   2943.\n10 2012-12-08   2797.\n# ℹ 256 more rows\n```\n\n\n:::\n:::\n\n    \n    (ii) What is the difference in average traffic volume between work days and the weekend/ a holiday?\n    \n<p style=\"color:blue\">*The first step is to create a variable which represents whether an observation comes from Monday-Friday or whether it's the weekend / a holiday.*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTraffic <- Traffic %>% \n  mutate( WorkDay = case_when( Weekday == \"Saturday\" ~ \"Weekend\",\n                               Weekday == \"Sunday\" ~ \"Weekend\",\n                               holiday != \"None\" ~ \"Weekend\",\n                               .default = \"Workday\" ) )\n```\n:::\n\n\n<p style=\"color:blue\">*Next, we calculate the average traffic volume for the two categories:*</p>\n  \n\n::: {.cell}\n\n```{.r .cell-code}\nAverageTraffic <- Traffic %>% \n  group_by( WorkDay ) %>%\n  summarise( Mean = mean(traffic_volume) )\n```\n:::\n\n\n<p style=\"color:blue\">*Finally, we calculate the difference in the averages:*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAverageTraffic$Mean[1] - AverageTraffic$Mean[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -982.8939\n```\n\n\n:::\n:::\n\n\nc) Create a plot which visualizes how the traffic volume changes throughout the day on Mondays.\n\n<p style=\"color:blue\">*We can extract the hour using the function hour() and combine it with functions from dplyr and ggplot we are familiar with:*</p>\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nTraffic %>%\n  filter( Weekday == \"Monday\" ) %>%\n  ggplot( aes(x=hour(date_time), y=traffic_volume) ) + \n  geom_point() + geom_smooth() + \n  labs( x=\"Hour of the Day\", y=\"Traffic Volume\" )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Quiz-4-Solution_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=50%}\n:::\n:::\n\n\n### **Exercise 3 - Weather in Brisbane and Gold Coast**\n\nThe file \"BrisbaneGoldCoast.csv\" contains daily weather measurements for Brisbane and Gold Coast in Australia. \n\na) Explore how the daily maximum temperature for Gold Coast varies throughout the year. Use the results from your analysis to answer the Moodle quiz.\n\n<p style=\"color:blue\">*Let's load the data:*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBrisbaneGoldCoast <- read.csv( \"data/BrisbaneGoldCoast.csv\" )\n```\n:::\n\n\n<p style=\"color:blue\">*As we want to plot values over time, the first step is to convert the variable* **Date** *to its correct type:*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBrisbaneGoldCoast <- BrisbaneGoldCoast %>% \n  mutate( Date = as_date( Date, format=\"%d/%m/%Y\" ) )\n```\n:::\n\n\n<p style=\"color:blue\">*For this analysis we only consider Gold Coast, and we thus we select the relevant observations:*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGoldCoast <- filter( BrisbaneGoldCoast, Location==\"GoldCoast\" )\n```\n:::\n\n\n<p style=\"color:blue\">*To explore variation throughout the year, we can create a line plot of the data:*</p>\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot( GoldCoast, aes( x=Date, y=MaxTemp ) ) + \n  geom_line( ) + labs( x=\"Date\", y=\"Maximum Temperature\" )\n```\n\n::: {.cell-output-display}\n![](Quiz-4-Solution_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=50%}\n:::\n:::\n\n\n<p style=\"color:blue\">*The plot shows that Gold Coast observes a seasonal pattern in the maximum daily temperature, with the highest temperatures recorded around December/January.*</p>\n\n<p style=\"color:blue\">*We can also study the average daily maximum temperature for each month to illustrate this further:*</p>\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nGoldCoast %>% \n  group_by( Month=month(Date) ) %>% \n  summarise( Mean=mean(MaxTemp, na.rm=TRUE) ) %>%\n  ggplot( aes(x=Month, y=Mean) ) + geom_line() + geom_point()\n```\n\n::: {.cell-output-display}\n![](Quiz-4-Solution_files/figure-html/unnamed-chunk-20-1.png){fig-align='center' width=50%}\n:::\n:::\n\n\nb) Create a scatter plot of the daily maximum temperature for Brisbane and Gold Coast. What do you conclude?\n\n<p style=\"color:blue\">*To explore the dependence between the sites via a scatter plot, we have to change the data structure using the tidyr package. Specifically, we want the measurements for Brisbane and Gold Coast in separate columns, which we achieve using*</p>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBGC_wide <- pivot_wider( BrisbaneGoldCoast, names_from=Location,\n                         values_from=MaxTemp:WindGustSpeed )\n```\n:::\n\n\n<p style=\"color:blue\">*We can now create scatter plots to analyse the dependence:*</p>\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot( BGC_wide, aes(x=MaxTemp_Brisbane, y=MaxTemp_GoldCoast) ) + \n  geom_point() + \n  labs( x=\"Maximum Brisbane\", y=\"Maximum Gold Coast\" )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 20 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Quiz-4-Solution_files/figure-html/unnamed-chunk-22-1.png){fig-align='center' width=40%}\n:::\n:::\n\n\n<p style=\"color:blue\">*The plot shows that the daily maximum temperatures for Brisbane and Gold Coast are quite similar. This strong dependence reflects their spatial proximity.*</p>\n",
    "supporting": [
      "Quiz-4-Solution_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}