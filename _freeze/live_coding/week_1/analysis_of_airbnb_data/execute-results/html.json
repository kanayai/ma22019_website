{
  "hash": "d461fbb918bac60b8cc32f89ac353ada",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Problem Class 1\"\nauthor: \"Dr. Karim Anaya-Izquierdo\"\nformat: html\n---\n\n\n\nWe have seen a few short examples in this week's lectures that illustrated the application of some functions in the dplyr R package. In this problem class we now study a more complex data set. We will also consider a few functions we did not cover so far, but which are useful in a wide range of applications.\n\n### Overview and Aims\n\nIn April 2018, all the information for properties listed on the online platform Airbnb for Rio de Janeiro, Brazil, was extracted. The data set is stored in the file \"Data/Airbnb Rio April 2018.csv\" on Moodle and contains six variables:\n\n* **host_id** - ID of the host on Airbnb\n\n* **host_since** - Date the host started to list their property on Airbnb\n\n* **neighbourhood** - Neighbourhood where the property is located\n\n* **guests_included** - Number of people included in the price\n\n* **price** - Price per night\n\n* **review_scores_rating** - Average rating for the property\n\nOur aim is to address two research questions using the methods we covered so far:\n\n1) Which neighbourhoods have a high number of listed properties?\n\n2) How does the price one would expect to pay vary across neighbourhoods?\n\nBefore starting the exercise, let's load the dplyr R package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary( dplyr )\n```\n:::\n\n\n\n### Data Cleaning\n\nWe start by loading the data into our R Workspace using the read.csv() function and looking at the loaded data,\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb_raw <- read.csv( \"Data/Airbnb Rio April 2018.csv\", header=TRUE )\nglimpse( Airbnb_raw )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 39,743\nColumns: 6\n$ host_id              <int> 53598, 68997, 99249, 102840, 135635, 153232, 1536~\n$ host_since           <chr> \"12/11/2009\", \"08/01/2010\", \"26/03/2010\", \"03/04/~\n$ neighbourhood        <chr> \"Botafogo\", \"Copacabana\", \"Ipanema\", \"Copacabana\"~\n$ guests_included      <int> 2, 2, 2, 2, 2, 2, 2, 1, 1, 7, 1, 8, 2, 4, 4, 1, 2~\n$ price                <chr> \"$133.00\", \"$270.00\", \"$222.00\", \"$161.00\", \"$222~\n$ review_scores_rating <int> 91, 93, 95, 94, 96, 94, 97, NA, 80, 87, 97, 80, 9~\n```\n\n\n:::\n:::\n\n\n**Task 1:** Which variables are required for addressing the research questions? Define a data frame **Airbnb** which only contains the necessary variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb <- Airbnb_raw %>%\n  select( neighbourhood, guests_included, price )\nglimpse( Airbnb )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 39,743\nColumns: 3\n$ neighbourhood   <chr> \"Botafogo\", \"Copacabana\", \"Ipanema\", \"Copacabana\", \"Ip~\n$ guests_included <int> 2, 2, 2, 2, 2, 2, 2, 1, 1, 7, 1, 8, 2, 4, 4, 1, 2, 4, ~\n$ price           <chr> \"$133.00\", \"$270.00\", \"$222.00\", \"$161.00\", \"$222.00\",~\n```\n\n\n:::\n:::\n\n\n**Task 2:** Convert the remaining variables to the correct type. **Hint:** You may want to consider the function **gsub()** to remove special symbols from a string of characters.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb <- Airbnb %>%\n  mutate( price = gsub(replacement = \"\", pattern=\"\\\\$\", price) )\nglimpse( Airbnb )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 39,743\nColumns: 3\n$ neighbourhood   <chr> \"Botafogo\", \"Copacabana\", \"Ipanema\", \"Copacabana\", \"Ip~\n$ guests_included <int> 2, 2, 2, 2, 2, 2, 2, 1, 1, 7, 1, 8, 2, 4, 4, 1, 2, 4, ~\n$ price           <chr> \"133.00\", \"270.00\", \"222.00\", \"161.00\", \"222.00\", \"308~\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb <- Airbnb %>%\n  mutate( price = gsub(replacement = \"\", pattern=\",\", price) )\nglimpse( Airbnb )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 39,743\nColumns: 3\n$ neighbourhood   <chr> \"Botafogo\", \"Copacabana\", \"Ipanema\", \"Copacabana\", \"Ip~\n$ guests_included <int> 2, 2, 2, 2, 2, 2, 2, 1, 1, 7, 1, 8, 2, 4, 4, 1, 2, 4, ~\n$ price           <chr> \"133.00\", \"270.00\", \"222.00\", \"161.00\", \"222.00\", \"308~\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb <- Airbnb %>%\n  mutate( price = as.numeric(price) )\nglimpse( Airbnb )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 39,743\nColumns: 3\n$ neighbourhood   <chr> \"Botafogo\", \"Copacabana\", \"Ipanema\", \"Copacabana\", \"Ip~\n$ guests_included <int> 2, 2, 2, 2, 2, 2, 2, 1, 1, 7, 1, 8, 2, 4, 4, 1, 2, 4, ~\n$ price           <dbl> 133, 270, 222, 161, 222, 308, 219, 150, 120, 3241, 106~\n```\n\n\n:::\n:::\n\n\n### Research Question 1\n\nWith the data now being ready, we can turn to our first research question:\n\n**Task 3:** Use the functions in the dplyr package to extract the number of properties per neighbourhood. **Hint:** You may want to consider the function **n()** which returns the number of rows in a data frame when combined with **summarise()**. Alternatively, you can also look up the function **count()**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb_Numbers <- Airbnb %>%\n  group_by( neighbourhood ) %>%\n  summarise( \"Number\" = n() )\nglimpse( Airbnb_Numbers )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 156\nColumns: 2\n$ neighbourhood <chr> \"\\303\\201gua Santa\", \"Aboli\\303\\247\\303\\243o\", \"Alto da ~\n$ Number        <int> 6, 8, 59, 9, 102, 87, 3, 17, 4528, 66, 4, 8, 13, 8, 1930~\n```\n\n\n:::\n:::\n\n\n\n**Task 4:** Sort the neighbourhoods based on the number of listed properties. For all neighbourhoods with more than 1000 listed properties, print the name of the neighbourhood and the number of listed properties. What do we conclude?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb_Numbers %>%\n  arrange( desc(Number) ) %>%\n  filter( Number>1000 )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 x 2\n   neighbourhood              Number\n   <chr>                       <int>\n 1 \"Copacabana\"                 9806\n 2 \"Barra da Tijuca\"            4528\n 3 \"Ipanema\"                    3351\n 4 \"Jacarepagu\\u00e1\"           2382\n 5 \"Recreio dos Bandeirantes\"   2096\n 6 \"Botafogo\"                   1930\n 7 \"Leblon\"                     1816\n 8 \"Santa Teresa\"               1312\n 9 \"Centro\"                     1049\n10 \"Flamengo\"                   1035\n```\n\n\n:::\n:::\n\n\n\n### Research Question 2\n\nThis research question is a bit more open-ended than Research Question 1. So we should first consider which information may be best suited for addressing the research question. \n\nOne possible answer is to study price per guest, as properties that can house a larger number of guests are likely to be more expensive. Summaries that may be helpful to extract are the average and median price per guest for a listed property within the neighbourhood. \n\n**Task 5:** Why may it be good to also consider the median, instead of just the mean?\n\n\n**Task 6:** Create a data frame which provides the number of listed properties, and the average and median price per guest, for each neighbourhood with more than 1000 listed properties. What do we conclude?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb <- Airbnb %>%\n  mutate( Price_per_Guest = price/guests_included )\nglimpse( Airbnb )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 39,743\nColumns: 4\n$ neighbourhood   <chr> \"Botafogo\", \"Copacabana\", \"Ipanema\", \"Copacabana\", \"Ip~\n$ guests_included <int> 2, 2, 2, 2, 2, 2, 2, 1, 1, 7, 1, 8, 2, 4, 4, 1, 2, 4, ~\n$ price           <dbl> 133, 270, 222, 161, 222, 308, 219, 150, 120, 3241, 106~\n$ Price_per_Guest <dbl> 66.500, 135.000, 111.000, 80.500, 111.000, 154.000, 10~\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAirbnb %>%\n  group_by( neighbourhood ) %>%\n  summarise( \"Number\"=n(),\n             Average = mean(Price_per_Guest),\n             Median = quantile(Price_per_Guest, 0.5) ) %>%\n  filter( Number>1000 )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 x 4\n   neighbourhood              Number Average Median\n   <chr>                       <int>   <dbl>  <dbl>\n 1 \"Barra da Tijuca\"            4528    897.   349 \n 2 \"Botafogo\"                   1930    331.   167.\n 3 \"Centro\"                     1049    252.   120 \n 4 \"Copacabana\"                 9806    360.   180.\n 5 \"Flamengo\"                   1035    356.   151 \n 6 \"Ipanema\"                    3351    496.   249 \n 7 \"Jacarepagu\\u00e1\"           2382    725.   360 \n 8 \"Leblon\"                     1816    599.   301 \n 9 \"Recreio dos Bandeirantes\"   2096    668.   332 \n10 \"Santa Teresa\"               1312    344.   130 \n```\n\n\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}