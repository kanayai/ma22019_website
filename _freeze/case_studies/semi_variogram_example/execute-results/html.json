{
  "hash": "3405e7c4eaf7b5584fded0f1a3380d88",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"MA22019 2025 - Revision Class\"\nauthor: \"Additional example on the semi-variogran\"\nformat: html\n---\n\n\n\n### Loading packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary( dplyr )\nlibrary( ggplot2 )\nlibrary( prettymapr )\nlibrary( ggspatial )\nlibrary( sp )\nlibrary( gstat )\n```\n:::\n\n\n### Loading the data\n\nThe file \"Manchester.csv\" contains some synthetic air pollution data for a day in Manchester:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nManchester <- read.csv(\"data/manchester.csv\" )\n```\n:::\n\n\n### Data visualization\n\nWe start by visualizing the data:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot( Manchester, aes( x=Lon, y=Lat ) ) + \n  annotation_map_tile( zoom=11 ) + \n  geom_spatial_point( aes(color=Level), size=4 ) +\n  scale_color_distiller( palette=\"Reds\", trans=\"reverse\" ) +\n  labs( x=\"Longitude\", y=\"Latitude\", color=\"PM10 Levels\" )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |======================================================================| 100%\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](semi_variogram_example_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n### Analysis of the spatial dependence\n\nWe estimate the semi-variogram using\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncoordinates( Manchester ) <- ~Lon+Lat\ngamma_hat <- variogram( Level~1, Manchester, cutoff=0.1 )\nggplot( gamma_hat, aes( x=dist, y=gamma/2 ) ) + geom_point( size=2 ) +\n  labs( x=\"Distance\", y=\"Semi-variogram\" )\n```\n\n::: {.cell-output-display}\n![](semi_variogram_example_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=50%}\n:::\n:::\n\n\na) What do we conclude?\n\nb) Is it reasonable to assume that (i) the mean is constant and (ii) dependence is fully specified by spatial distance?\n\n",
    "supporting": [
      "semi_variogram_example_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}