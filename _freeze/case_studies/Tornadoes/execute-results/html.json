{
  "hash": "d4fcda29cbd9e0096403eb82683e4444",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis of Tornado Data\"\nauthor: \"Christian Rohrbeck\"\ndate: \"02/04/2025\"\nformat: html\n---\n\n\n\n## Loading the packages and the tornado data set\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(sf)\nlibrary(ggspatial)\nlibrary(prettymapr)\nlibrary(spatstat)\n\nTornadoes <- read.csv(\"data/tornadoes.csv\" )\n```\n:::\n\n\n# Point pattern analysis for Kansas and Texas\n\n## Visualize the data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot( Tornadoes, aes( Lon, y=Lat ) ) + annotation_map_tile() + \n  geom_spatial_point() + labs( x=\"Longitude\", y=\"Latitude\" )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nAssuming `crs = 4326` in stat_spatial_identity()\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nZoom: 3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nFetching 4 missing tiles\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |======================================================================| 100%\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n...complete!\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Tornadoes_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=55%}\n:::\n:::\n\n\n\n### Load the shapefile for the United States\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUSA <- read_sf( \"Shapefile USA/gadm41_USA_1.shp\" )\n```\n:::\n\n\n\n### Extract the shapefiles for Kansas and Texas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nKS <- filter( USA, NAME_1==\"Kansas\" ) %>% \n  st_simplify( dTolerance = 2000 )\n\nTX <- filter( USA, NAME_1==\"Texas\" ) %>% \n  st_simplify( dTolerance = 2000 ) \n```\n:::\n\n\n### Transform the points and shapefiles to a different projection\n\nWe transform the shapefiles and points to a projection different to WGS84 - this seems odd, but it is necessary to create the ppp object later:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nKS <- KS %>% st_transform( crs=3857 )\nTX <- TX %>% st_transform( crs=3857 )\n\nTornadoes_transformed <- Tornadoes %>%\n  st_as_sf( coords=c(\"Lon\",\"Lat\"), crs=4326 ) %>%\n  st_transform( crs=3857 ) %>% \n  st_coordinates( )\n```\n:::\n\n\n### Create the ppp objects\n\nThis is the second possibility of creating a ppp objetc we will introduce - it's more work due to the required change in projection, but it is more rigorous in return:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTexas_ppp <- ppp( Tornadoes_transformed[,1], Tornadoes_transformed[,2], \n                  window = as.owin(TX) )\nKansas_ppp <- ppp( Tornadoes_transformed[,1], Tornadoes_transformed[,2],\n                   window = as.owin(KS) )\n```\n:::\n\n\n### Estimate and visualize the kernel smoothed intensity function\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npar( mai=c(0.01,0.5,0.2,0.5), mfrow=c(1,2) )\nlambdaC_KS <- density.ppp( Kansas_ppp, edge=TRUE )\nplot( lambdaC_KS, main=\"Kansas\" )\nlambdaC_TX <- density.ppp( Texas_ppp, edge=TRUE )\nplot( lambdaC_TX, main=\"Texas\" )\n```\n\n::: {.cell-output-display}\n![Corrected smoothed kernel intensity for the occurrence of tornadoes across Kansas and Texas.](Tornadoes_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n# Visualizing the number of tornadoes per state\n\n## Extract number of tornadoes per state\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTornadoesNumbers <- Tornadoes %>% count( State )\n```\n:::\n\n\n## Combine the number with the data frame for the shapefile\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUSA <- st_simplify( USA, dTolerance = 5000, preserveTopology = TRUE )\nUSA$HASC_1 <- gsub( \".*\\\\.\", \"\", USA$HASC_1)\nUSA <- inner_join( USA, TornadoesNumbers, by=c(\"HASC_1\"=\"State\") ) \n```\n:::\n\n\n## Remove Alaska and Hawaii\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUSA <- USA %>% \n  filter( !NAME_1 %in% c(\"Alaska\", \"Hawaii\") ) %>%\n  rename( State = NAME_1, Number=n )\n```\n:::\n\n\n## Create the plot\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot( USA, aes(fill=Number) ) + theme_bw() + \n  annotation_map_tile( zoom=4 ) + geom_sf() +\n  scale_fill_distiller( palette=\"Reds\", trans=\"reverse\" ) + \n  labs( fill=\"Number\", x=\"Longitude\", y=\"Latitude\" ) +\n  theme( axis.title=element_text(size=15), axis.text=element_text(size=15) )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |======================================================================| 100%\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Tornadoes_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=80%}\n:::\n:::\n\n",
    "supporting": [
      "Tornadoes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}