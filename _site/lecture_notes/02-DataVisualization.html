<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>datavisualization – MA22019</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../lecture_notes/03-Text-Data-Analysis.html" rel="next">
<link href="../lecture_notes/01-DataWrangling.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-bb1cd4028f63a369ab283e072cb7d572.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-4f208714201d96898fd04a32119b1e84.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lecture_notes/index.html">Lecture Notes</a></li><li class="breadcrumb-item"><a href="../lecture_notes/02-DataVisualization.html">Data Visualization</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Computing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing_setup/project_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project Structure</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing_setup/setup_university_drive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">University Drive Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing_setup/computing_assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments Workflow</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing_setup/why_quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Why Quarto?</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Lecture Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture_notes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture_notes/01-DataWrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture_notes/02-DataVisualization.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture_notes/03-Text-Data-Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Text Data Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture_notes/04-SpatialDataAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Data Analysis</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Slides</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Labs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework &amp; Quizzes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../coursework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coursework</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#data-visualization" id="toc-data-visualization" class="nav-link active" data-scroll-target="#data-visualization">Data Visualization</a>
  <ul class="collapse">
<li>
<a href="#background-on-data-visualization" id="toc-background-on-data-visualization" class="nav-link" data-scroll-target="#background-on-data-visualization">Background on data visualization</a>
  <ul class="collapse">
<li><a href="#visual-cues" id="toc-visual-cues" class="nav-link" data-scroll-target="#visual-cues">Visual cues</a></li>
  <li><a href="#example-freediving-world-records" id="toc-example-freediving-world-records" class="nav-link" data-scroll-target="#example-freediving-world-records">Example: Freediving world records</a></li>
  <li><a href="#coordinate-system" id="toc-coordinate-system" class="nav-link" data-scroll-target="#coordinate-system">Coordinate system</a></li>
  <li><a href="#example-analysis-of-wind-direction-and-speed" id="toc-example-analysis-of-wind-direction-and-speed" class="nav-link" data-scroll-target="#example-analysis-of-wind-direction-and-speed">Example: Analysis of wind direction and speed</a></li>
  <li><a href="#scale-and-context" id="toc-scale-and-context" class="nav-link" data-scroll-target="#scale-and-context">Scale and context</a></li>
  </ul>
</li>
  <li>
<a href="#analysis-of-australian-weather-data-using-ggplot2" id="toc-analysis-of-australian-weather-data-using-ggplot2" class="nav-link" data-scroll-target="#analysis-of-australian-weather-data-using-ggplot2">Analysis of Australian weather data using ggplot2</a>
  <ul class="collapse">
<li><a href="#initializing-a-plot" id="toc-initializing-a-plot" class="nav-link" data-scroll-target="#initializing-a-plot">Initializing a plot</a></li>
  <li><a href="#scatter-plots" id="toc-scatter-plots" class="nav-link" data-scroll-target="#scatter-plots">Scatter plots</a></li>
  <li><a href="#line-plots" id="toc-line-plots" class="nav-link" data-scroll-target="#line-plots">Line plots</a></li>
  <li><a href="#histograms-and-density-plots" id="toc-histograms-and-density-plots" class="nav-link" data-scroll-target="#histograms-and-density-plots">Histograms and density plots</a></li>
  <li><a href="#box-and-violin-plots" id="toc-box-and-violin-plots" class="nav-link" data-scroll-target="#box-and-violin-plots">Box and violin plots</a></li>
  </ul>
</li>
  <li>
<a href="#creating-advanced-plots-with-ggplot2" id="toc-creating-advanced-plots-with-ggplot2" class="nav-link" data-scroll-target="#creating-advanced-plots-with-ggplot2">Creating advanced plots with ggplot2</a>
  <ul class="collapse">
<li><a href="#changing-the-coordinate-system" id="toc-changing-the-coordinate-system" class="nav-link" data-scroll-target="#changing-the-coordinate-system">Changing the coordinate system</a></li>
  <li><a href="#changing-scales" id="toc-changing-scales" class="nav-link" data-scroll-target="#changing-scales">Changing scales</a></li>
  <li><a href="#changing-font-size" id="toc-changing-font-size" class="nav-link" data-scroll-target="#changing-font-size">Changing font size</a></li>
  <li><a href="#changing-colour-schemes" id="toc-changing-colour-schemes" class="nav-link" data-scroll-target="#changing-colour-schemes">Changing colour schemes</a></li>
  </ul>
</li>
  <li><a href="#changing-the-data-structure" id="toc-changing-the-data-structure" class="nav-link" data-scroll-target="#changing-the-data-structure">Changing the data structure</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lecture_notes/index.html">Lecture Notes</a></li><li class="breadcrumb-item"><a href="../lecture_notes/02-DataVisualization.html">Data Visualization</a></li></ol></nav></header><section id="data-visualization" class="level1"><h1>Data Visualization</h1>
<p>In Chapter 1 we explored how to restructure a data set and extract summaries. In this chapter we will focus on <strong>data visualization</strong>, i.e., the creation and interpretation of plots that give us further insight into the data. Data visualization is not just important for data exploration, but also for presenting and communicating results.</p>
<p>There are two very important aspects we need to keep in mind:</p>
<ol type="1">
<li><p>Effective data visualization is more about clear communication than creating impressive plots. Your analysis may be excellent, but it won’t attract any attention if you cannot convey your results effectively.</p></li>
<li><p>Plots support our arguments and/or highlight the reason for our conclusion. As such we should interpret plots in the context of the research question and not just provide a plot as the answer.</p></li>
</ol>
<p>We start by introducing a general framework for describing data graphics in Section <a href="#background-on-data-visualization">2.1</a>. Sections <a href="#analysis-of-australian-weather-data-using-ggplot2">2.2</a> and <a href="#creating-advanced-plots-with-ggplot2">2.3</a> then demonstrate how to use the R package <strong>ggplot2</strong> for data visualization. Finally, some further aspects are considered in Section <a href="#changing-the-data-structure">2.4</a>.</p>
<p><strong>Remark:</strong> The methods and techniques considered in this chapter cover general aspects of data visualization. Specific methods for illustrating text and spatial data are left to the next chapters.</p>
<p><strong>Important:</strong> Data visualization is to some degree subjective, because there is often not just one way to visualize the data. However, you should follow the principles outlined in this chapter, and your conclusions need to be supported by your plot. Do not claim something that is not clearly visible in your output!</p>
<section id="background-on-data-visualization" class="level2"><h2 class="anchored" data-anchor-id="background-on-data-visualization">Background on data visualization</h2>
<p>Before starting to create plots in R, we establish a framework to analyze plots in terms of four basic elements: <strong>visual cues</strong>, <strong>coordinate system</strong>, <strong>scale</strong> and <strong>context</strong>. Understanding these elements will help us with producing our own plots later.</p>
<section id="visual-cues" class="level3"><h3 class="anchored" data-anchor-id="visual-cues">Visual cues</h3>
<p>Visual cues are graphical elements that draw the audience to the aspects we want them to focus on. The book <em>“Data points: Visualization that means something”</em> by Nathan Yau (link provided on Moodle) lists nine distinct visual cues to encode a category or quantity:</p>
<ul>
<li><p>Position (quantity) - relation to other things</p></li>
<li><p>Length (quantity) - size in one dimension</p></li>
<li><p>Angle (quantity) - width of angle may, for instance, represent proportions (pie chart)</p></li>
<li><p>Direction (quantity) - slope of line</p></li>
<li><p>Shape (category) - which observations are in the same group</p></li>
<li><p>Area (quantity) - size in two dimensions</p></li>
<li><p>Volume (quantity) - size in three dimensions</p></li>
<li><p>Shade (quantity or category) - shade in comparison to others, or grouping</p></li>
<li><p>Colour (quantity or category) - colour in comparison to others, or grouping</p></li>
</ul>
<p>Research has shown that our ability to perceive differences in magnitude descends in this order. One of many publications supporting this argument is <em>“Graphical perception: Theory, experimentation, and application to the development of graphical methods.”</em>, which you can find on Moodle.</p>
<p><strong>Important:</strong> One crucial conclusion is that we should not rely too much on colour. Many people have colour deficiencies, which makes it very hard for them to distinguish certain colours. Consequently, before using colour, we should consider whether we could use shapes or shades instead.</p>
<p><strong>Remark:</strong> In this course we focus on creating 2D graphics. While 3D plots and animations allow us to visualize a larger number of variables (and you may think they look more impressive), I would avoid using such plots except for a very limited number of cases. That’s because it is often difficult to see the exact positions of the points.</p>
</section><section id="example-freediving-world-records" class="level3"><h3 class="anchored" data-anchor-id="example-freediving-world-records">Example: Freediving world records</h3>
<p>The data set “Freediving Records.csv” provides information on the progression of the world record in multiple disciplines for men and women. We will focus on the discipline “dynamic apnea with fins (DYN)” and visualize how the world records for men and women have progressed over time:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/DNY-1.png" class="img-fluid figure-img" style="width:55.0%"></p>
<figcaption>Development of the world record in dynamic apnea with fins (DYN) for men and women between 1993 and 2020.</figcaption></figure>
</div>
</div>
</div>
<p>We can identify that the following visual cues have been used:</p>
<ul>
<li><p>Shape and colour indicate whether the observations refer to the world record for men or women. Note, there is no issue with using multiple cues for the same information.</p></li>
<li><p>Length of line is used to convey two pieces of information: (i) the length of the line in horizontal direction indicates the time it took until the world record was broken, and (ii) the length of the line in vertical direction represents the magnitude of improvement.</p></li>
<li><p>Position is used to compare the world records for men and women (both lines are provided in the plot).</p></li>
<li><p>Shape is used to highlight the times when a world record was broken - this makes it is easy to count the number of times the record was broken. Without this visual cue, such information would be much harder to extract from the plot.</p></li>
</ul></section><section id="coordinate-system" class="level3"><h3 class="anchored" data-anchor-id="coordinate-system">Coordinate system</h3>
<p>Choosing a suitable coordinate system is critical to present the data accurately and in a meaningful way. The three most common coordinate systems used in data science are</p>
<dl>
<dt><strong>Cartesian:</strong></dt>
<dd>
<p>Our familiar (<span class="math inline">\(x,y\)</span>)-rectangular coordinate system with two perpendicular axes.</p>
</dd>
<dt><strong>Polar:</strong></dt>
<dd>
<p>Points are identified by their radius <span class="math inline">\(r\)</span> (distance from the origin) and angle <span class="math inline">\(\theta\)</span>. A point (<span class="math inline">\(x,y\)</span>) in Cartesian coordinates can be transformed to polar coordinates using the relationship [ (x,y) = (r, r), r=. ]</p>
</dd>
<dt><strong>Geographical:</strong></dt>
<dd>
<p>In the chapter on spatial data analysis, we will work with points located across the earth, with their positions being defined by longitude and latitude.</p>
</dd>
</dl>
<p>There are two common cases when we may want to consider polar coordinates:</p>
<ol type="1">
<li><p>Pie charts</p></li>
<li><p>Variables which naturally lie on a circle, such as wind direction.</p></li>
</ol>
<p><strong>Tip:</strong> Since <strong>Position</strong> and <strong>Length</strong> are better visual cues than <strong>Angle</strong>, we should prefer Cartesian coordinates to polar coordinates. For instance, before using pie charts, consider whether the same information can be displayed effectively in a bar plot. However, we will see some examples where polar coordinates may be considered the better choice.</p>
</section><section id="example-analysis-of-wind-direction-and-speed" class="level3"><h3 class="anchored" data-anchor-id="example-analysis-of-wind-direction-and-speed">Example: Analysis of wind direction and speed</h3>
<p>Hourly weather data was collected for Bela Vista, Brazil, for 2017 and 2018. Suppose we were asked to explore the distribution of wind direction and the relation between wind direction and speed of wind gusts.</p>
<p>To analyse the distribution of wind direction, we may create a histogram of the collected data. Let’s compare the histograms obtained for the Cartesian and polar coordinate systems (both display frequency):</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/BVWind1-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption>Frequency of wind direction for Bela Vista, Brazil, in 2017 and 2018 displayed using Cartesian coordinates (left) and polar coordinates (right).</figcaption></figure>
</div>
</div>
</div>
<p>Both plots, Cartesian (left) and polar (right), show that the wind predominately comes from a north-easterly direction. The right plot is a tick nicer, because it better handles that <span class="math inline">\(0^{\circ}=360^{\circ}\)</span> in terms of wind direction, which is recorded as an angle.</p>
<p>Let’s turn to analyzing the relation between wind direction and speed of wind gusts. For this we create plots which map wind direction against the speed of the wind gusts, again using different coordinate systems:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/BVWind2-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption>Wind direction versus speed of wind gust for Bela Vista in 2017 and 2018 displayed using Cartesian coordinates (left) and polar coordinates (right).</figcaption></figure>
</div>
</div>
</div>
<p><strong>What can we conclude about the relation between wind direction and speed of wind gusts?</strong></p>
<p>I personally prefer the left plot because it indicates the difference in frequency of wind directions. The right plot (using polar coordinates) does not provide this information and it seems almost as if wind direction is uniformly distributed - so we would need the histogram in Figure @ref(fig:BVWind1) to correctly interpret the plot.</p>
</section><section id="scale-and-context" class="level3"><h3 class="anchored" data-anchor-id="scale-and-context">Scale and context</h3>
<p>The concepts of scale and context refer to the choice of axes and the labeling of the data graphic respectively.</p>
<section id="scale" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="scale">Scale</h4>
<p>Scales allow us to translate values into visual cues by influencing, for instance, the distance (length) between points in a scatter plot. When choosing scales, we have to consider how the displayed distances translate into meaningful differences. Each coordinate axis can have its own scale, and we have three different choices:</p>
<p><strong>Numerical:</strong> Numeric quantities, such as speed, age, etc., are commonly set on a linear, logarithmic or percentage scale.</p>
<p><strong>Categorical:</strong> Categorical variables may have no ordering (political parties), or be <strong>ordinal</strong> (restaurant ratings). Ordinal variables differ from numeric quantities in that distances are unknown (or not meaningful). For instance, a first class degree is better than a 2.1, but what does this mean in terms of distance?</p>
<p><strong>Time:</strong> While being a numeric quantity, time has some special properties: 1) it can be demarcated by year, month,.. and 2) it can be considered periodical. This second aspect can be highlighted using polar coordinates as seen in Section <a href="#example-analysis-of-wind-direction-and-speed">2.1.4</a>.</p>
</section><section id="context" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="context">Context</h4>
<p>Data graphics are provided to aid the reader/viewer with making meaningful comparisons. Context can be added in the form of titles, subtitles and axis labels that explain what is being shown, including the scales and units. It sometimes also helps to include reference points or lines. While we should avoid cluttering or providing excessive annotations, it is necessary to provide proper context.</p>
</section><section id="example-relation-between-body-and-brain-weight-for-mammals" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="example-relation-between-body-and-brain-weight-for-mammals">Example: Relation between body and brain weight for mammals</h4>
<p>The following two plots both illustrate the relation between body weight and brain weight for several mammals, but they use different scales:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/Mammals-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption>Body weight vs brain weight for 62 mammals on linear scale (left) and logarithmic scale (right).</figcaption></figure>
</div>
</div>
</div>
<p>We make two observations:</p>
<ul>
<li><p>Linear scales were used in the left plot, while logarithmic scales were used in the right plot - this context was provided via the title.</p></li>
<li><p>The right plot is more informative as it shows a linear relationship between body and brain weight on logarithmic scale. This aspect is not clear in the left plot, and a viewer may focus on the three mammals with the highest brain weight as they appear to be quite different from the rest.</p></li>
</ul></section></section></section><section id="analysis-of-australian-weather-data-using-ggplot2" class="level2"><h2 class="anchored" data-anchor-id="analysis-of-australian-weather-data-using-ggplot2">Analysis of Australian weather data using ggplot2</h2>
<p>After outlining the different elements of a plot in the previous section, we now explore how we can create informative plots using the <strong>ggplot2</strong> R package</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span> <span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We will introduce and utilize a wide range of plots to analyze historical weather data for five Australian cities. The data is provided on Moodle as “WeatherAustralia.csv” and we start by loading the data and looking at the first few entries:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">AUS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/weatheraustralia.csv"</span> <span class="op">)</span></span>
<span><span class="fu">slice_head</span><span class="op">(</span> <span class="va">AUS</span>, n<span class="op">=</span><span class="fl">5</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Date Location MinTemp MaxTemp Rainfall WindGustSpeed
1 01/01/2009   Sydney    17.7    35.1        0            72
2 02/01/2009   Sydney    18.5    23.0        0            63
3 03/01/2009   Sydney    16.9    23.2        0            NA
4 04/01/2009   Sydney    18.7    27.1        0            65
5 05/01/2009   Sydney    20.2    31.6        0            63</code></pre>
</div>
</div>
<p>We see that the data provide daily information on minimum and maximum temperature, amount of rainfall and wind speed. Further, the data also include some missing values, as highlighted by the <span class="math inline">\(\mathrm{\texttt{NA}}\)</span> entries.</p>
<p>In the following, we perform a data exploration which includes the creation and interpretation of multiple plots. At the end of the analysis, you will be familiar with the general functionality of the ggplot2 package. Further types of plots are listed on the ggplot2 cheat sheet (provided on Moodle). I would advise you to try creating some of them for practice, as they may be useful.</p>
<p><strong>Important:</strong> In this section we focus on the different types of plots and visual cues. The other elements described in Section <a href="Background on data visualization">2.1</a>, coordinate system, scale and context, will be considered in Section <a href="Creating advanced plots with ggplot2">2.3</a>.</p>
<section id="initializing-a-plot" class="level3"><h3 class="anchored" data-anchor-id="initializing-a-plot">Initializing a plot</h3>
<p>The first step is to call the function <strong>ggplot()</strong> and we usually specify the following inputs:</p>
<ol type="1">
<li><p>The <strong>name of the data frame</strong> that contains the data we want to plot</p></li>
<li><p>The <strong>names of the variables</strong> which specify the axes. This is done using the function <strong>aes()</strong>, which refers to <em>aesthetics</em> (we will see this very often).</p></li>
</ol>
<p>Suppose we want to create a scatter plot of minimum against maximum temperature for the five Australian cities. To initialize the plot, we specify</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PlotAUS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">AUS</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">MinTemp</span>, y<span class="op">=</span><span class="va">MaxTemp</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>However, if we call <strong>PlotAUS</strong> in R, we will see a Cartesian coordinate system, but no points. This is because the coordinate system and visual cues are specified using separate functions in ggplot2. We will consider in the next subsection how to add points as an additional layer.</p>
<p><strong>Remark:</strong> While it is important to use meaningful variable names when programming, I usually make an exception when using ggplot2. For instance, instead of <strong>PlotAUS</strong>, we could also call it <strong>g</strong> (for graphic) - I will later use this for brevity.</p>
</section><section id="scatter-plots" class="level3"><h3 class="anchored" data-anchor-id="scatter-plots">Scatter plots</h3>
<p>The function <strong>geom_point()</strong> adds the points to the coordinate system created by ggplot(). Returning to the Australian weather data, we generate the scatter plot of daily minimum and maximum temperature using</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PlotAUS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption>Minimum versus maximum observed daily temperature for five Australian cities between 2008 and 2017.</figcaption></figure>
</div>
</div>
</div>
<p>We observe a positive correlation between minimum and maximum daily temperature. However, this plot does not highlight that the data are coming from five different cities. In other words, the plot does not allow us to explore differences between the cities.</p>
<p>One possible solution is to use the visual cues shape and colour to indicate to which city a data point belongs. Specifically, we specify via aes() that the variable <strong>Location</strong> should be used to determine the shape and colour of the points created by the geom_point() function:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PlotAUS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> shape<span class="op">=</span><span class="va">Location</span>, color<span class="op">=</span><span class="va">Location</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Minimum versus maximum observed daily temperature for five Australian cities between 2008 and 2017, with the city being highlighted using the visual cues of shape and colour.</figcaption></figure>
</div>
</div>
</div>
<p><strong>Remark:</strong> If we wanted to use shade, we would have specified <span class="math inline">\(\mathrm{\texttt{aes( alpha=Location )}}\)</span>.</p>
<p>While our plot now makes clear that the data come from different cities, it is still very cluttered. This makes it hard to draw conclusions on differences between the five Australian cities. Luckily, there is a better option available, which we consider next.</p>
<section id="facets" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="facets">Facets</h4>
<p>Instead of creating a single plot which contains all points, it seems a nice idea to have a separate plot for each city. In other words, we want to split the data using the variable <strong>Location</strong> and create one plot per subset.</p>
<p>This type of plot is called a <strong>facet</strong> plot and it provides a simple and effective way to display the data for the separate levels of a categorical variable.</p>
<p>To create the facet plot, we use the function <strong>facet_wrap()</strong> and change the axes labels using the <strong>labs()</strong> function:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PlotAUS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span><span class="va">Location</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Minimum daily temperature"</span>, y<span class="op">=</span><span class="st">"Maximum daily temperature"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/Facets-1.png" class="img-fluid figure-img" style="width:89.0%"></p>
<figcaption>Plots of minimum versus maximum daily temperature between 2008 and 2017 for five Australian cities.</figcaption></figure>
</div>
</div>
</div>
<p>Our plot now reveals that Darwin is quite different from the other four cities in terms of the distribution of minimum and maximum daily temperature, in particular, in terms of the range of values.</p>
<p><strong>What may be the reason for this difference? What else can we conclude?</strong></p>
</section></section><section id="line-plots" class="level3"><h3 class="anchored" data-anchor-id="line-plots">Line plots</h3>
<p>As for the river flow data in Section [1.1.4][Example: Loading and cleaning NRFA river flow data], we may want to explore how a variable changes over time for one of the five cities.</p>
<p>Scatter plots are often not the right choice for such a task, because it’s hard to see patterns in the data. Instead we create a line plot, where the length of the line connecting consecutive dates illustrates the magnitude of change in the values of the variable.</p>
<p>Let’s see how we can create a line plot for daily maximum temperature over time for Darwin. We start by converting the variable <strong>Date</strong> in the data frame to the correct type,</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">AUS</span> <span class="op">&lt;-</span> <span class="va">AUS</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span> Date <span class="op">=</span> <span class="fu">as_date</span><span class="op">(</span> <span class="va">Date</span>, format<span class="op">=</span><span class="st">"%d/%m/%Y"</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The next step is to extract the subset of observations for Darwin, which we store in a separate data frame called <strong>Darwin</strong>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Darwin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span> <span class="va">AUS</span>, <span class="va">Location</span> <span class="op">==</span> <span class="st">"Darwin"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>A line plot is then created by using the <strong>geom_line()</strong> function, again by first defining the axes in the ggplot() function:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">Darwin</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">Date</span>, y<span class="op">=</span><span class="va">MaxTemp</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Maximum daily temperature"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Time series plot of daily maximum temperature for Darwin between 2008 and 2017.</figcaption></figure>
</div>
</div>
</div>
<p>To create such a (time series) plot for all five cities, we again use facet_wrap(), and we use colour and shape (line type) to highlight the different cities:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">AUS</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">Date</span>, y<span class="op">=</span><span class="va">MaxTemp</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span><span class="va">Location</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> color<span class="op">=</span><span class="va">Location</span>, linetype<span class="op">=</span><span class="va">Location</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Date"</span>, y<span class="op">=</span><span class="st">"Maximum daily temperature"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/DateTempFacet-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Time series plot of daily maximum temperature for five Australian cities between 2008 and 2017.</figcaption></figure>
</div>
</div>
</div>
<p>The gap in the plot for Melbourne is due to the data being missing for this time period. One conclusion we draw from the plot is that the maximum daily temperature is less varied for Darwin than the other cities, which exhibit a clear seasonal pattern.</p>
<p><strong>Remark 1:</strong> To draw steps as in Section <a href="#example-freediving-world-records">2.1.2</a>, we would use <strong>geom_step()</strong> instead of geom_line().</p>
<p><strong>Remark 2:</strong> The use of colour and shape in Figure @ref(fig:DateTempFacet) is not really necessary. We just did it do illustrate that visual cues can be used together with facet_wrap().</p>
</section><section id="histograms-and-density-plots" class="level3"><h3 class="anchored" data-anchor-id="histograms-and-density-plots">Histograms and density plots</h3>
<p>We now want to investigate the distribution of a single variable, such as the speed of the wind gusts in one (or more) of the cities. Histograms and <strong>density plots</strong> are useful in such cases. You already created histograms in Year 1 Probability &amp; Statistics and we analyzed such a plot in Section <a href="#example-analysis-of-wind-direction-and-speed">2.1.4</a>. We start by producing a histogram using ggplot2 and then introduce the density plot in more detail.</p>
<section id="histograms" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="histograms">Histograms</h4>
<p>The ggplot2 package provides the function <strong>geom_histogram()</strong> to create a histogram. As for the hist() function you used before, we have to set a suitable number of bins, and this is done using the <strong>bins</strong> option inside the geom_histogram() function.</p>
<p>Let’s return to the data for Darwin. To create a histogram for wind speed gusts, we have to call ggplot() and geom_histogram(), but we now only specify the x-axis:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">Darwin</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">WindGustSpeed</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span> bins<span class="op">=</span><span class="fl">20</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Speed of wind gust in km/h"</span>, y<span class="op">=</span><span class="st">"Count"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption>Histogram of the speed of wind gusts for Darwin between 2008 and 2017.</figcaption></figure>
</div>
</div>
</div>
<p><strong>What could be a sensible distribution for the speed of wind gusts, based on the histogram?</strong></p>
</section><section id="density-plots" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="density-plots">Density plots</h4>
<p>A density plot is pretty much a <em>smoothed</em> version of the histogram. Given data <span class="math inline">\(x_1,\ldots,x_n\)</span>, we define the estimate <span class="math inline">\(\hat{f}_X(\cdot)\)</span> for the probability density function <span class="math inline">\(f_X(\cdot)\)</span> of the random variable <span class="math inline">\(X\)</span> as <span class="math display">\[\begin{equation}
\hat{f}_X(x) = \frac{1}{nh}\sum_{i=1}^{n} K\left(\frac{x-x_i}{h}\right), \qquad x\in\mathbb{R},
(\#eq:KDE)
\end{equation}\]</span> where <span class="math inline">\(K(\cdot)\)</span> is termed the <strong>kernel</strong> and <span class="math inline">\(h\)</span> is called the <strong>bandwidth</strong>. The kernel is a non-negative probability density function. One common choice is to set <span class="math inline">\(K(\cdot)\)</span> as the density of the standard normal distribution, with [ <em>X(x) = </em>{i=1}^{n}{-}. ]</p>
<p>In principle, the bandwidth <span class="math inline">\(h\)</span> has to be set by us. If <span class="math inline">\(h\)</span> is too small, the density plot will look very jittered, while a too large <span class="math inline">\(h\)</span> will obscure the underlying data structure. Consequently, care should be taken when setting the bandwidth.</p>
<p><strong>Remark 1:</strong> When generating density plots in R, a suitable value for <span class="math inline">\(h\)</span> is often provided automatically. However, we sometimes have to set the bandwidth manually.</p>
<p><strong>Remark 2:</strong> It is usually sufficient to provide either the histogram or the density plot, because they visualize similar aspects of the data. Note, the histogram should be used for discrete data.</p>
<p>In ggplot2, <strong>geom_density()</strong> is used to create density plots and, as for geom_histogram(), we only specify the x-axis. Let’s use this type of plot to compare the distributions of the speed of wind gusts for Darwin and Adelaide. To aid the comparison, we place the estimates for the two cities in the same plot:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WeatherAD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span> <span class="va">AUS</span>, <span class="va">Location</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adelaide"</span>,<span class="st">"Darwin"</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">WeatherAD</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">WindGustSpeed</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> linetype<span class="op">=</span><span class="va">Location</span>, color<span class="op">=</span><span class="va">Location</span> <span class="op">)</span>, size<span class="op">=</span><span class="fl">1.2</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Speed of wind gust in km/h"</span>, y<span class="op">=</span><span class="st">"Density"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/DAWind-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
<figcaption>Density plots of the speed of wind gusts for Adelaide (solid) and Darwin (dashed) for 2008–2017.</figcaption></figure>
</div>
</div>
</div>
<p>The two estimated curves indicate that Adelaide and Darwin differ in the distribution of wind gust speeds. For instance, Adelaide observes wind gust speeds below 30 km/h more often than Darwin.</p>
<p><strong>Remark 1:</strong> The option <span class="math inline">\(\mathrm{\texttt{size=1.2}}\)</span> in geom_density() increases the thickness of the line in the plot - you can set <strong>size</strong> to any positive value, and higher values will give thicker lines. If you wanted to specify the bandwidth <span class="math inline">\(h\)</span> in @ref(eq:KDE), you have the option <span class="math inline">\(\mathrm{\texttt{bw=..}}\)</span>.</p>
<p><strong>Remark 2:</strong> Density plots can sometimes be misleading because they are a smoothed version of the histogram. Although Adelaide and Darwin appear to have a similar density in Figure @ref(fig:DAWind) when it comes to high wind speeds, the highest value for Adelaide is 86 km/h, while it is 126 km/h for Darwin. Consequently, we should be cautious when drawing conclusions about the distribution tails based on density plots.</p>
</section></section><section id="box-and-violin-plots" class="level3"><h3 class="anchored" data-anchor-id="box-and-violin-plots">Box and violin plots</h3>
<p>Box plots and violin plots are useful for comparing a number of distributions. For instance, we may want to compare the distributions of wind gust speed for the five Australian cities. While we could produce a separate density plot for each city, box and violin plots tend to be a better choice.</p>
<p>The two types of plot differ in terms of the information they provide:</p>
<ul>
<li><p>Box plots visualize the median, interquartile range (25% and 75% quantile) and outliers.</p></li>
<li><p>Violin plots visualize the density estimate <span class="math inline">\(\hat{f}_X(\cdot)\)</span> as defined in Equation @ref(eq:KDE).</p></li>
</ul>
<section id="box-plots" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="box-plots">Box plots</h4>
<p>In ggplot2, box plots are created using the <strong>geom_boxplot()</strong> function. Let’s use this type of plot to compare the wind gust speeds across the five cities. We set the x-axis to the categorical variable <strong>Location</strong>, and the y-axis as speed of wind gust:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">AUS</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">Location</span>, y<span class="op">=</span><span class="va">WindGustSpeed</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> fill<span class="op">=</span><span class="va">Location</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> y<span class="op">=</span><span class="st">"Speed of wind gust in km/h"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/Box-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Box plots of the speed of wind gusts for five Australian cities between 2008 and 2017.</figcaption></figure>
</div>
</div>
</div>
<p>We can extract a few details about the distributions of the speed of wind gusts for the five cities. For instance, when considering the median, Melbourne and Sydney record the strongest wind gusts, while Adelaide and Perth record the lowest wind gust speeds.</p>
<p><strong>Remark 1:</strong> The option <span class="math inline">\(\mathrm{\texttt{fill=Location}}\)</span> gives each box plot a different colour.</p>
<p><strong>Remark 2:</strong> If we wanted a single box plot for a variable, we would only specify one of the axes.</p>
</section><section id="violin-plots" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="violin-plots">Violin plots</h4>
<p>To conclude our analysis, we compare the distribution of daily wind gust speeds across the five Australian cities using violin plots. This type of plot is generated using the <strong>geom_violin()</strong> function, and the syntax is the same as for geom_boxplot(). We make two additions compared to Figure @ref(fig:Box) though:</p>
<ol type="1">
<li><p>A plot title is set using the labs() function.</p></li>
<li><p>It’s good practice to order box and violin plots, for instance, based on the median of the different subgroups. This is achieved using the <strong>reorder()</strong> function.</p></li>
</ol>
<p>Putting everything together, the five violin plots are generated using</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">AUS</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Location</span>, <span class="va">WindGustSpeed</span>, <span class="va">median</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                  y<span class="op">=</span><span class="va">WindGustSpeed</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Location"</span>, y<span class="op">=</span><span class="st">"Wind gust speed in mph"</span>, </span>
<span>        title<span class="op">=</span><span class="st">"Wind gust speed across five Australian cities"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:68.0%"></p>
<figcaption>Violin plots of wind speed across five cities in Australia. The cities are ordered in ascending order in terms of their median wind gust speed.</figcaption></figure>
</div>
</div>
</div>
<p><strong>Remark:</strong> The four components within reorder() should be read as follows: (i) We want to reorder the values in <strong>Location</strong>, (ii) which should be based on the variable <strong>WindGustSpeed</strong>, (iii) the value to be used for the reordering is the median and (iv) ignore any missing values when calculating the median.</p>
<p>By ordering the violin plots, we can directly draw the conclusion that Adelaide has the lowest median wind gust speed, while Sydney has the highest. There are also other conclusions that are worth pointing out, such as the differences in terms of highest observed wind gust speeds.</p>
</section></section></section><section id="creating-advanced-plots-with-ggplot2" class="level2"><h2 class="anchored" data-anchor-id="creating-advanced-plots-with-ggplot2">Creating advanced plots with ggplot2</h2>
<p>In the previous section we generated plots using the structure [ + _. ] and this allowed us to create several type of plots and to use multiple visual cues. The following table lists the types of plots we explored so far (plus the functions for generating bar plots):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 30%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Type of plot</th>
<th style="text-align: left;"><span class="math inline">\(\mathrm{\texttt{&lt;GEOM}}\_\mathrm{\texttt{FUNCTION&gt;}}\)</span></th>
<th style="text-align: left;">Visual cues we may use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Scatter plot</td>
<td style="text-align: left;"><strong>geom_point</strong></td>
<td style="text-align: left;">shape, shade, colour, size</td>
</tr>
<tr class="even">
<td style="text-align: left;">Line plot</td>
<td style="text-align: left;"><strong>geom_line</strong></td>
<td style="text-align: left;">shade, colour, linetype, size</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>geom_step</strong></td>
<td style="text-align: left;">shade, colour, linetype, size</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bar plot</td>
<td style="text-align: left;"><strong>geom_bar</strong></td>
<td style="text-align: left;">shade, colour, size</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><strong>geom_col</strong></td>
<td style="text-align: left;">shade, colour, size</td>
</tr>
<tr class="even">
<td style="text-align: left;">Histogram</td>
<td style="text-align: left;"><strong>geom_histogram</strong></td>
<td style="text-align: left;">shade, colour, linetype</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Box plot</td>
<td style="text-align: left;"><strong>geom_boxplot</strong></td>
<td style="text-align: left;">shade, colour</td>
</tr>
<tr class="even">
<td style="text-align: left;">Density plot</td>
<td style="text-align: left;"><strong>geom_density</strong></td>
<td style="text-align: left;">shade, colour, linetype</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Violin plot</td>
<td style="text-align: left;"><strong>geom_violin</strong></td>
<td style="text-align: left;">shade, colour, linetype</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<p>We also covered a few additional aspects, such as using facet_wrap() to create facets and labs() to specify the axes labels. In this section we consider the remaining plot elements described in Section <a href="#background-on-data-visualization">2.1</a>:</p>
<ul>
<li><p>Changing the coordinate system to polar coordinates</p></li>
<li><p>Changing the scale of the x-axis (y-axis)</p></li>
</ul>
<p>We will also explore how to change the font size of the labels and the colour scheme in our plot. This will give us a lot of flexibility to visualize data.</p>
<section id="changing-the-coordinate-system" class="level3"><h3 class="anchored" data-anchor-id="changing-the-coordinate-system">Changing the coordinate system</h3>
<p>We saw in Section <a href="#analysis-of-australian-weather-data-using-ggplot2">2.2</a> that ggplot() uses the Cartesian coordinate system by default. In Section <a href="#coordinate-system">2.1.3</a> we highlighted that we sometimes want to use polar coordinates, for instance, when displaying wind direction. The <strong>coord_polar()</strong> function in ggplot2 allows us to switch from Cartesian to polar coordinates. Let’s consider two cases where such a transformation may be useful.</p>
<section id="visualizing-direction" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="visualizing-direction">Visualizing direction</h4>
<p>In Figures @ref(fig:BVWind1) and @ref(fig:BVWind2) we used plots with polar coordinates to explore wind direction and speed for Bela Vista, Brazil. We can reproduce these plots in ggplot2:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span> <span class="co"># required to place plots next to each other</span></span>
<span><span class="va">wind_BV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/wind_bela_vista.csv"</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">wind_BV</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">Wind.Direction</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span> bins <span class="op">=</span> <span class="fl">120</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_radial.html">coord_polar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Wind Direction"</span> <span class="op">)</span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">wind_BV</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">Wind.Direction</span>, y<span class="op">=</span><span class="va">Gust.Speed</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_radial.html">coord_polar</a></span><span class="op">(</span> theta<span class="op">=</span><span class="st">"x"</span> <span class="op">)</span>  <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Wind Direction"</span>, y<span class="op">=</span><span class="st">"Wind gust in m/s"</span> <span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">+</span> <span class="va">g2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/BVWindNew-1.png" class="img-fluid figure-img" style="width:88.0%"></p>
<figcaption>Histogram illustrating the frequency of wind direction (left) and scatter plot of wind direction vs wind speed (right) for Bela Vista, Brazil. Both plots use polar coordinates. The solid line in the right plot shows the average wind speed for each wind direction.</figcaption></figure>
</div>
</div>
</div>
<p>The option <span class="math inline">\(\mathrm{\texttt{theta="x"}}\)</span> in coord_polar() specifies that the angle should be defined by the x-axis. We do not have to do anything else - ggplot2 is doing all the calculations for us.</p>
<p><strong>Remark 1:</strong> The R package <strong>patchwork</strong> makes it easy to place two graphics created by ggplot2 next to each other by using the <strong>+</strong> sign. There are more options available - have a look at the documentation for the package.</p>
<p><strong>Remark 2:</strong> The example also shows that we can use multiple geom_..() functions in the same plot. Here, we used geom_smooth() to add a line representing the average wind speed in each direction to the plot. However, we note that the line does not match up at <span class="math inline">\(0^{\circ}\)</span>. This is not particularly elegant, but there is not a very easy fix to this.</p>
<p><strong>Are there any other plots we should create to explore the distribution of wind direction and speed of wind gusts at Bela Vista, Brazil?</strong></p>
</section><section id="pie-charts" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="pie-charts">Pie Charts</h4>
<p>In a pie chart we use the size of the angle as a visual cue and such a plot may be useful to visualize proportions. The following R code illustrates how to create a pie chart using ggplot2:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> <span class="st">"prob"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span><span class="op">)</span>, <span class="st">"group"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="va">prob</span>, fill<span class="op">=</span><span class="va">group</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_radial.html">coord_polar</a></span><span class="op">(</span> theta<span class="op">=</span><span class="st">"y"</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">""</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:55.0%"></p>
<figcaption>Example of a pie chart with three slices.</figcaption></figure>
</div>
</div>
</div>
<p>The code first creates a plot on Cartesian coordinates - a stacked bar plot in this case - which is then converted to polar coordinates. To see this, you may want to have a look at the plot you obtain when removing coord_polar() from the code above.</p>
</section></section><section id="changing-scales" class="level3"><h3 class="anchored" data-anchor-id="changing-scales">Changing scales</h3>
<p>We saw in Section <a href="#scale-and-context">2.1.5</a> that changing the scale of one (or more) variables in a plot can help with the data analysis. In applications, transformations are often used to reduce the influence of extreme outliers in the plot. For instance, by considering logarithmic scales in Section <a href="#scale-and-context">2.1.5</a>, the three mammals with very high brain weight in the data appeared less extreme, and we were instead able to see the possible linear relationship on logarithmic scale between brain and body weight.</p>
<p>When using ggplot(), a linear scale is used by default. The function <strong>coord_trans()</strong> enables us to change the scale of the x-axis or y-axis. The most common transformations are logarithmic (<span class="math inline">\(\mathrm{\texttt{x="log"}}\)</span> or <span class="math inline">\(\mathrm{\texttt{x="log10"}}\)</span>) and square root (<span class="math inline">\(\mathrm{\texttt{x="sqrt"}}\)</span>).</p>
<section id="example-analysis-of-facebook-data" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="example-analysis-of-facebook-data">Example: Analysis of Facebook Data</h4>
<p>The data in “Facebook.csv” contains data related to messages posted by a few Olympic athletes. We want to explore the relation between number of likes (received for individual posts) and the number of followers of the athlete. Let’s produce two plots, one with linear scales and one with logarithmic scales:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Facebook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/facebook.csv"</span>, header<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">g</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">Facebook</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">follow</span>, y<span class="op">=</span><span class="va">postlikes</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Number of Followers"</span>, y<span class="op">=</span><span class="st">"Number of likes"</span> <span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_transform.html">coord_trans</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"log"</span>, y<span class="op">=</span><span class="st">"log"</span> <span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">+</span> <span class="va">g2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/Facebook-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption>Number of followers vs number of likes on linear scale (left) and logarithmic scale (right) for Facebook posts by a group of Olympic athletes.</figcaption></figure>
</div>
</div>
</div>
<p>We see that the two plots provide quite different information: The graphic with log-transformed scales shows a possible linear relationship between log(number of followers) and log(number of likes), which is not visible when considering the plot with linear scales.</p>
<p><strong>Remark:</strong> If you want to use another transformation than logarithmic or square root, you can specify it within ggplot. For instance, we could use</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">Facebook</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">follow</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">postlikes</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"log(Number of Followers)"</span>, y<span class="op">=</span><span class="st">"log(Number of likes)"</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You have to be aware that the numbers along the axes differ in this case, and you have to change the axis labels to highlight that the values are on logarithmic scale.</p>
</section></section><section id="changing-font-size" class="level3"><h3 class="anchored" data-anchor-id="changing-font-size">Changing font size</h3>
<p>When we produce plots, we may find that, for instance, the axis labels are too small. Further, we may want to change the margins around our graphics. The <strong>theme()</strong> function allows us to do all this (and much more).</p>
<p>In Figure @ref(fig:Facebook) the axis labels are quite small and it may be nice to have a little bit of a gap between the plots. Let’s use the theme() function to achieve this. To visualize the difference, we only alter the setup of the second plot.</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="va">g2</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span> plot.margin<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span> t<span class="op">=</span><span class="fl">0</span>, l<span class="op">=</span><span class="fl">100</span>, b<span class="op">=</span><span class="fl">0</span>, r<span class="op">=</span><span class="fl">0</span> <span class="op">)</span>,</span>
<span>         axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>,</span>
<span>         axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">g1</span> <span class="op">+</span> <span class="va">g2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:98.0%"></p>
<figcaption>Number of followers vs number of likes on linear scale (left) and logarithmic scale (right) for Facebook posts by a group of Olympic athletes.</figcaption></figure>
</div>
</div>
</div>
<p>We see that the gap between the plots has widened, and that the font size of the axis labels and numbers in the right plot have increased. Font size in ggplot2 is specified via <strong>element_text(size=..)</strong>:</p>
<ul>
<li><p>Font size of the title is changed with <strong>theme( title=element_text(size=..) )</strong></p></li>
<li><p>Font size of the axis labels is changed with <strong>theme( axis.title=element_text(size=..) )</strong></p></li>
<li><p>Font size in the legend can be changed with <strong>theme( legend.title=element_text(size=..) )</strong> and <strong>theme( legend.text=element_text(size=..) )</strong></p></li>
</ul>
<p><strong>Remark:</strong> Making sure that labels are provided in a suitable font size is important. The gap between the plots is more of a personal preference.</p>
</section><section id="changing-colour-schemes" class="level3"><h3 class="anchored" data-anchor-id="changing-colour-schemes">Changing colour schemes</h3>
<p>So far we used the default colour scheme provided by ggplot2. There are situations, however, where we may want to change the colour scheme. One easy way to achieve this is by using the functions <strong>scale_filler_brewer()</strong> and <strong>scale_colour_brewer()</strong> in ggplot2 - which of these to use depends on whether you specified <strong>fill=..</strong> or <strong>colour=..</strong> in aes().</p>
<p><strong>Example:</strong> Let’s reproduce the box plots in Section <a href="#box-and-violin-plots">2.2.6</a>, but with an orange colour scheme</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">AUS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/weatheraustralia.csv"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">AUS</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span><span class="va">Location</span>,y<span class="op">=</span><span class="va">WindGustSpeed</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">Location</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> y<span class="op">=</span><span class="st">"Speed of wind gust in km/h"</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span> palette<span class="op">=</span><span class="st">"Oranges"</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span> axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>, axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Box plots of the speed of wind gust for 5 cities in Australia.</figcaption></figure>
</div>
</div>
</div>
<p><strong>Remark:</strong> We used <strong>theme_bw()</strong> to change the background colour from grey to white.</p>
<p>There are multiple colour blind friendly patterns available for scale_filler_brewer() and scale_colour_brewer(), which you can view using</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span> <span class="va">RColorBrewer</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span> colorblindFriendly <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>List of colour blind friendly palettes that can be used to visualize discrete variables in ggplot2.</figcaption></figure>
</div>
</div>
</div>
<p>Note, the colour schemes above are useful when applied to visualize a discrete variable with a small number of different values, such as the five Australian cities. We will see in Chapter [4][Spatial Data Analysis] how to change the colour scheme when visualizing a continuous random variable.</p>
</section></section><section id="changing-the-data-structure" class="level2"><h2 class="anchored" data-anchor-id="changing-the-data-structure">Changing the data structure</h2>
<p>Generally speaking, ggplot2 plots different columns in a data frame against each other, and each row is considered as a single observation. However, in practice the data structure may not be as required.</p>
<p>The functions <strong>pivot_wider()</strong> and <strong>pivot_longer()</strong> in the <strong>tidyr</strong> package may provide one way to address this. Before considering an example, let’s load the tidyr package:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span> <span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="temperature-in-manaus---comparison-of-months" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="temperature-in-manaus---comparison-of-months">Temperature in Manaus - Comparison of months</h4>
<p>The file “Manaus Temperature.csv” provides the average temperature for each month in the years 1910-2019 for the city of Manaus, Brazil. Let’s load and investigate the data:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Manaus_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/manaus_temperature.csv"</span> <span class="op">)</span></span>
<span><span class="fu">slice_head</span><span class="op">(</span> <span class="va">Manaus_raw</span>, n<span class="op">=</span><span class="fl">4</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  YEAR  JAN  FEB  MAR  APR  MAY  JUN  JUL  AUG  SEP  OCT  NOV  DEC
1 1910 27.3 27.0 26.5 26.2 27.2 27.5 27.7 28.0 29.0 28.3 28.3 27.8
2 1911 27.0 27.4 27.4 27.3 27.2 27.0 27.4 28.3 29.0 29.1 28.8 28.3
3 1912 29.0 28.8 28.3 28.0 27.3 28.1 27.4 28.8 28.3 29.3 29.2 27.5
4 1913 27.2 28.1 27.3 27.6 27.0 27.6 27.7 27.7 28.7 28.7 28.8 28.5</code></pre>
</div>
</div>
<p>We see that each row corresponds to one year of data. If we wanted to compare two months with each other, the data structure would be ideal for us to create a scatter plot with ggplot2. Let’s compare the temperatures for January and February:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">Manaus_raw</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> <span class="st">"x"</span><span class="op">=</span><span class="va">JAN</span>, <span class="st">"y"</span><span class="op">=</span><span class="va">FEB</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Average Temperature in January"</span>, y<span class="op">=</span><span class="st">"Average Temperature in February"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" style="width:51.0%"></p>
<figcaption>Scatter plot of the reported average temperatures for January and February for Manaus, Brazil.</figcaption></figure>
</div>
</div>
</div>
<p>The plot looks very odd and some of the data points have a value of <span class="math inline">\(999.9\)</span>. Since such high temperatures are highly unlikely, we conclude that the value <span class="math inline">\(999.9\)</span> is used to indicate missing data. Let’s replace these values for January and February by <span class="math inline">\(\mathrm{\texttt{NA}}\)</span>. We can do this using case_when() or by using the na_if() function in dplyr:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Manaus</span> <span class="op">&lt;-</span> <span class="va">Manaus_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span> JAN <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span> <span class="va">JAN</span>, <span class="fl">999.9</span> <span class="op">)</span>, FEB <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span> <span class="va">FEB</span>, <span class="fl">999.9</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can now create the plot again</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="va">Manaus</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> <span class="st">"x"</span><span class="op">=</span><span class="va">JAN</span>, <span class="st">"y"</span><span class="op">=</span><span class="va">FEB</span> <span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> x<span class="op">=</span><span class="st">"Average Temperature in January"</span>, y<span class="op">=</span><span class="st">"Average Temperature in February"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span> axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 16 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" style="width:51.0%"></p>
<figcaption>Scatter plot of the monthly average temperature for January and February for Manaus, Brazil.</figcaption></figure>
</div>
</div>
</div>
<p>We see that there is a positive correlation between the average monthly temperatures for Sao Paulo and Rio de Janeiro.</p>
</section><section id="temperature-in-manaus---temperatures-across-time" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="temperature-in-manaus---temperatures-across-time">Temperature in Manaus - Temperatures across time</h4>
<p>Let’s assume that we also wanted to explore average temperature over time. In this case, a line plot would be a good choice. However, the data frame provides no single column which contains the monthly average temperatures.</p>
<p>The function pivot_longer() allows us to change the structure of the data frame by combining the columns <strong>JAN</strong> to <strong>DEC</strong> into a single column</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Manaus_long</span> <span class="op">&lt;-</span> <span class="va">Manaus_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span> cols<span class="op">=</span><span class="va">JAN</span><span class="op">:</span><span class="va">DEC</span>, names_to<span class="op">=</span><span class="st">"Month"</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">rename</span><span class="op">(</span> Temperature <span class="op">=</span> <span class="va">value</span> <span class="op">)</span></span>
<span><span class="fu">slice_head</span><span class="op">(</span> <span class="va">Manaus_long</span>, n<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
   YEAR Month Temperature
  &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
1  1910 JAN          27.3
2  1910 FEB          27  
3  1910 MAR          26.5</code></pre>
</div>
</div>
<p>So we have converted the original table to a narrower but substantially longer table with 3 columns; the pivot_longer() function by default stores the observed monthly averages in a column named <strong>value</strong>, which we renamed to <strong>Temperature</strong>.</p>
<p>If we wanted to reverse back to the original format, we would use the function <strong>pivot_wider()</strong>,</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Manaus_wide</span> <span class="op">&lt;-</span> <span class="va">Manaus_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span> names_from<span class="op">=</span><span class="va">Month</span>, values_from<span class="op">=</span><span class="va">Temperature</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Each row in <strong>Manaus_long</strong> now corresponds to one month instead of one year. The one challenge that remains is to convert the variables <strong>YEAR</strong> and <strong>MONTH</strong> into a single variable that represents the date. There is unfortunately no easy way, but the following code does the job</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Convert abbreviation for month into number</span></span>
<span><span class="va">Manaus_long</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">Manaus_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span> Month <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span> </span>
<span>    <span class="va">Month</span> <span class="op">==</span> <span class="st">"JAN"</span> <span class="op">~</span> <span class="st">"01"</span>, <span class="va">Month</span> <span class="op">==</span> <span class="st">"FEB"</span> <span class="op">~</span> <span class="st">"02"</span>, <span class="va">Month</span> <span class="op">==</span> <span class="st">"MAR"</span> <span class="op">~</span> <span class="st">"03"</span>, </span>
<span>    <span class="va">Month</span> <span class="op">==</span> <span class="st">"APR"</span> <span class="op">~</span> <span class="st">"04"</span>, <span class="va">Month</span> <span class="op">==</span> <span class="st">"MAY"</span> <span class="op">~</span> <span class="st">"05"</span>, <span class="va">Month</span> <span class="op">==</span> <span class="st">"JUN"</span> <span class="op">~</span> <span class="st">"06"</span>,</span>
<span>    <span class="va">Month</span> <span class="op">==</span> <span class="st">"JUL"</span> <span class="op">~</span> <span class="st">"07"</span>, <span class="va">Month</span> <span class="op">==</span> <span class="st">"AUG"</span> <span class="op">~</span> <span class="st">"08"</span>, <span class="va">Month</span> <span class="op">==</span> <span class="st">"SEP"</span> <span class="op">~</span> <span class="st">"09"</span>, </span>
<span>    <span class="va">Month</span> <span class="op">==</span> <span class="st">"OCT"</span> <span class="op">~</span> <span class="st">"10"</span>, <span class="va">Month</span> <span class="op">==</span> <span class="st">"NOV"</span> <span class="op">~</span> <span class="st">"11"</span>, <span class="va">Month</span> <span class="op">==</span> <span class="st">"DEC"</span> <span class="op">~</span> <span class="st">"12"</span></span>
<span>    <span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co">## Combine year and month and convert to date</span></span>
<span><span class="va">Manaus_long</span> <span class="op">&lt;-</span> <span class="va">Manaus_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span> Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span> <span class="va">Manaus_long</span><span class="op">$</span><span class="va">YEAR</span>, <span class="va">Manaus_long</span><span class="op">$</span><span class="va">Month</span>, sep<span class="op">=</span><span class="st">"-"</span> <span class="op">)</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span> Date <span class="op">=</span> <span class="fu">ym</span><span class="op">(</span> <span class="va">Date</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Finally, we can create our line plot. We have to keep in mind that we still have entries of value 999.9 which we do not want to plot. We again replace values of 999.9 with <span class="math inline">\(\mathrm{\texttt{NA}}\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Manaus_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span> Temperature <span class="op">=</span> <span class="fu">na_if</span><span class="op">(</span> <span class="va">Temperature</span>, <span class="fl">999.9</span> <span class="op">)</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">=</span><span class="va">Date</span>, <span class="st">"y"</span><span class="op">=</span><span class="va">Temperature</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> y<span class="op">=</span><span class="st">"Average Monthly Temperature"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span> axis.title<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">16</span><span class="op">)</span>, axis.text<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-DataVisualization_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:55.0%"></p>
<figcaption>Average monthly temperature for Manaus, Brazil, between 1910 and 2019.</figcaption></figure>
</div>
</div>
</div>
<p>The plot indicates an increase in the average monthly temperature from about 27.5 to 29 degree Celsius over the time period.</p>
<p><strong>Remark:</strong> The last piece of code shows that we can use the pipe together with the functions from ggplot2.</p>
</section></section><section id="summary" class="level2"><h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>We covered some of the principles regarding data visualization:</p>
<ol type="1">
<li><p>When designing your data graphic, ensure that the main message/aspect is clearly visible and provide an interpretation of your plot. Avoid presenting plots that are not focused towards answering the research question.</p></li>
<li><p>The important types of graphics we use for data visualization and exploration are line plot, scatter plot, bar plot, histogram, density plot, box plot and violin plot.</p></li>
<li>
<p>Graphics can be discussed in terms of four elements:</p>
<ul>
<li><p>Visual cues</p></li>
<li><p>Coordinate system</p></li>
<li><p>Scale</p></li>
<li><p>Context</p></li>
</ul>
</li>
<li><p>The ggplot2 R package provides a wide range of tools for creating data graphics from a given data frame. This includes changing the coordinate system, the scale and selecting a wide range of types of graphics.</p></li>
<li><p>For complex data sets it is often useful to use facets and a wide range of visual cues. This may improve accessibility for the reader.</p></li>
<li><p>In practice we often have to restructure the data using the dplyr and tidyr packages before creating the data graphic.</p></li>
</ol>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../lecture_notes/01-DataWrangling.html" class="pagination-link" aria-label="Data Wrangling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Data Wrangling</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../lecture_notes/03-Text-Data-Analysis.html" class="pagination-link" aria-label="Text Data Analysis">
        <span class="nav-page-text">Text Data Analysis</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, University of Bath</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>


</body></html>